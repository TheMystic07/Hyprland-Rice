"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4904,7994,8721],{16287:(e,t,i)=>{i.d(t,{A:()=>r,h:()=>d});var o=i(53877),n=i(72126),s=i(23867),a=i(54642);async function r(e,t){const{store:i,activityIds:o,spaceId:r,filterActivityTypes:d,filterDateRange:c,navigableBlockId:p,collectionId:u}=t,g=n.Ps(o),m=await a.getActivityLog(e,{spaceId:r,navigableBlock:p?{id:p,spaceId:(0,s.C)(void 0)}:void 0,collection:u?{id:u,spaceId:(0,s.C)(void 0)}:void 0,endingBeforeId:g,limit:20,activityTypes:d,...l(c)});if("failed"===m.type)throw m.error;const v=m.data.activityIds;i.update((e=>({...e,shouldLoadNewerActivities:!1,activityIds:v.concat(o)})))}async function d(e,t){const{store:i,activityIds:o,spaceId:r,filterActivityTypes:d,filterDateRange:c,navigableBlockId:p,collectionId:u}=t,g=n.Z$(o),m=await a.getActivityLog(e,{spaceId:r,navigableBlock:p?{id:p,spaceId:(0,s.C)(void 0)}:void 0,collection:u?{id:u,spaceId:(0,s.C)(void 0)}:void 0,startingAfterId:g,limit:20,activityTypes:d,...l(c)});if("failed"===m.type)throw m.error;const v=m.data.activityIds;i.update((e=>({...e,shouldLoadOlderActivities:!1,activityIds:o.concat(v),hasOlderActivities:v.length>0})))}function l(e){var t,i;const n=null!==(t=e.ending)&&void 0!==t&&t.start_date?o.OQ.isoToUnixMs(e.ending.start_date):void 0;return{startingAfterTimeMs:null!==(i=e.starting)&&void 0!==i&&i.start_date?o.OQ.isoToUnixMs(e.starting.start_date):void 0,endingBeforeTimeMs:n?o.Xz({date:n,daysToAdd:1}):void 0}}},84708:(e,t,i)=>{i.d(t,{Z:()=>z});var o=i(23174),n=i.n(o),s=i(67294),a=i(83355),r=i(69651),d=i(72050),l=i(72126),c=i(44615),p=i(70921),u=i(63143),g=i(5366),m=i(16287),v=i(19719),y=i(17652),f=i(65598),h=i(95697),b=i(51811),S=i(77907),M=i(2688),w=i(5162),C=i(44904),k=i(80444),I=i(61766),A=i(88632),T=i(49085);class x extends T.default{getInitialState(){return{selectedItems:[]}}}const Z=x;var F=i(4761),P=i(68785),_=i(77137),D=i(43145),B=i(93481),R=i(10434),O=i.n(R),U=i(52275),L=i(255),V=i(8319);class K extends a.Z{constructor(){super(...arguments),this.storeTypes={store:Z},this.renderFilterListItem=(e,t)=>{var i,o;let{disabled:s,onRemove:a,onClick:r}=t;const d=this.styles,l=n()(L.Z,{disabled:s,onClick:a});return n()(U.Z,{title:(null===(i=(o=this.props).getItemLabel)||void 0===i?void 0:i.call(o,e))||e,disabled:s,focused:!1,right:l,style:d.menuItem,desktopTitleStyle:d.menuItemTitle,onClick:r},e)},this.renderItemForSummary=e=>`hello${e}`,this.renderToken=e=>e,this.renderResultMenuItem=(e,t)=>{var i,o;return s.createElement(U.Z,O()({},t,{key:e,title:(null===(i=(o=this.props).getItemLabel)||void 0===i?void 0:i.call(o,e))||e,checkState:this.props.mode===V.z.Pill&&this.stores.store.state.selectedItems.includes(e)}))},this.performRequest=e=>{let{query:t}=e;return Promise.resolve(this.props.options.filter((e=>e.includes(t))))},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:4}}}willMountOrUpdate(e){this.stores.store.setState({selectedItems:e.items})}renderComponent(){const{mode:e,title:t,onChange:i,disabled:o,focused:s,onMenuDismiss:a,items:r,addItemLabel:d,tokenInputPlaceholder:l,resultSectionTitle:c,componentDebugName:p,icon:u}=this.props;return n()(V.Z,{mode:e,hasItemsSelected:this.stores.store.state.selectedItems.length>0,title:t,icon:u,items:r,onChange:e=>{i(e)},disabled:o,focused:s,renderFilter:(e,t)=>this.renderFilterListItem(e,t),renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:d,labelText:{title:t,tokenInputPlaceholder:l,resultSectionTitle:c,componentDebugName:p},performRequest:this.performRequest,renderResultMenuItem:(e,t)=>this.renderResultMenuItem(e,t),onMenuDismiss:a})}}K.displayName="SearchListFilter";const E=K;var N=i(70268);class H extends a.Z{constructor(){super(...arguments),this.searchListFilterStore=new Z,this.storeTypes={activityUpdatesStore:C.o,filterPopupStore:I.Z},this.closeAddFilterMenu=()=>{const{filterPopupStore:e}=this.stores;e.setState({...e.state,open:!1})},this.renderActivityTypeFilter=()=>{const{collectionId:e}=this.props,t=e=>s.createElement(s.Fragment,null,n()(E,{store:this.searchListFilterStore,focused:!1,icon:d.A,options:[...e].sort(),items:this.stores.activityUpdatesStore.state.filterActivityTypes,mode:V.z.Pill,title:n()(g.FormattedMessage,{id:"activityUpdates.filterMenu.byType.title",defaultMessage:"Activity type"}),tokenInputPlaceholder:this.props.intl.formatMessage({id:"activityUpdates.filterMenu.byType.search",defaultMessage:"Search for a type"}),resultSectionTitle:this.props.intl.formatMessage({id:"activityUpdates.filterMenu.byType.resultSectionTitle",defaultMessage:"Activity Types"}),addItemLabel:this.props.intl.formatMessage({id:"activityUpdates.filterMenu.byType.addItemLabel",defaultMessage:"Add an activity type"}),componentDebugName:"ActivityUpdatesSearchEditTypesFilter",onChange:e=>this.updateFiltersAndTrackChange((()=>this.stores.activityUpdatesStore.update((t=>({...t,filterActivityTypes:e,activityIds:[],hasOlderActivities:!0,shouldLoadOlderActivities:!0,shouldLoadNewerActivities:!1}))))),onMenuDismiss:this.closeAddFilterMenu,getItemLabel:e=>e.split("-").map((e=>e.replace(/(^.)/,(e=>e.toUpperCase())))).join(" ")}));return t(e?p.Se:p.Py)},this.renderActivityTimeFilter=()=>n()(B.Z,{mode:V.z.Pill,focused:!1,showButtons:!0,title:n()(g.FormattedMessage,{id:"activityUpdates.filterMenu.byDate",defaultMessage:"Date Range"}),icon:r.C,value:this.stores.activityUpdatesStore.state.filterDateRange,onMenuDismiss:this.closeAddFilterMenu,onChange:e=>this.updateFiltersAndTrackChange((()=>this.stores.activityUpdatesStore.update((t=>({...t,filterDateRange:e,activityIds:[],hasOlderActivities:!0,shouldLoadOlderActivities:!0})))))}),this.renderSearchFilters=()=>{const{currentUserStore:e,currentSpaceStore:t}=k.default.state;if(!e||!t)return;const i=this.stores.activityUpdatesStore.state.filterActivityTypes.length>0||this.stores.activityUpdatesStore.state.filterDateRange.ending||this.stores.activityUpdatesStore.state.filterDateRange.starting;return n()("div",{style:{display:"flex",flexDirection:"row",padding:"12px 10px",width:"100%",gap:6}},void 0,this.renderActivityTypeFilter(),this.renderActivityTimeFilter(),i&&this.renderClearButton())},this.handleActivityEmit=e=>{this.stores.activityUpdatesStore.update((e=>({...e,shouldLoadNewerActivities:!0})))},this.handleActivityEmitThrottled=l.P2(this.handleActivityEmit,1e3),this.handleNavigableBlockEmit=u.YX(this.handleActivityEmitThrottled),this.handleCollectionEmit=u.YX(this.handleActivityEmitThrottled),this.navigableBlockListenerReference=void 0,this.collectionListenerReference=void 0}willMount(){this.startMessageListeners()}willUnmount(){this.stopMessageListeners()}renderComponent(){return A.Z.state.online?this.renderOnline():this.renderOffline()}renderClearButton(){return n()("div",{style:{flexGrow:1,textAlign:"right",cursor:"pointer",fontSize:14,color:this.theme.mediumTextColor,marginRight:8},onClick:()=>this.updateFiltersAndTrackChange((()=>this.stores.activityUpdatesStore.reset()))},void 0,n()(g.FormattedMessage,{defaultMessage:"Clear",id:"activityUpdates.clearFilters"}))}renderOffline(){return n()("div",{style:this.getPlaceholderContentStyle()},void 0,n()(g.FormattedMessage,{defaultMessage:"Please go online to view updates.",id:"activityUpdates.offlineMessage"}))}updateFiltersAndTrackChange(e){const t=this.getFilterDataForTracking();e();const i=this.getFilterDataForTracking();v.Q6({environment:this.environment,activityUpdatesSource:this.props.source,filters:i,prevFilters:t})}renderOnline(){const{spaceId:e,navigableBlock:t,collectionId:i,source:o}=this.props,{currentUserStore:s,currentSpaceStore:a}=k.default.state;if(!s||!a)return;const r=a,{shouldLoadOlderActivities:d,shouldLoadNewerActivities:l,filterActivityTypes:c,filterDateRange:p,activityIds:u,hasOlderActivities:v}=this.stores.activityUpdatesStore.state,f=s.id,M=null==t?void 0:t.id;return n()(_.Z,{throttle:1e3,request:{spaceId:e,navigableBlockId:M,collectionId:i,shouldLoadOlderActivities:d,shouldLoadNewerActivities:l,filterActivityTypes:c,filterDateRange:p,hasOlderActivities:v,activityIds:u},performRequest:async e=>{const{spaceId:t,navigableBlockId:i,collectionId:o,shouldLoadOlderActivities:n,shouldLoadNewerActivities:s,filterDateRange:a,filterActivityTypes:r,hasOlderActivities:d,activityIds:l}=e,c=F.ZP.startLoading();s?await m.A(this.environment,{store:this.stores.activityUpdatesStore,activityIds:l,spaceId:t,filterActivityTypes:r,filterDateRange:a,navigableBlockId:i,collectionId:o}):n&&d&&await m.h(this.environment,{store:this.stores.activityUpdatesStore,activityIds:l,spaceId:t,filterActivityTypes:r,filterDateRange:a,navigableBlockId:i,collectionId:o}),F.ZP.endLoading(c)},render:(t,s,a)=>{var l,u;const{activityIds:m}=this.stores.activityUpdatesStore.state;if(t)return n()("div",{style:this.getPlaceholderContentStyle()},void 0,n()(g.FormattedMessage,{defaultMessage:"Something went wrong.",id:"activityUpdate.unknownErrorLoadingActivities.message"}));const C=(0,h.oI)(),k=(0,w.Y)("supportsNativeHome"),I={spaceId:e,userId:f,navigableBlockId:M,collectionId:i,filterDateRange:p,filterActivityTypes:c},A=k&&0===m.length&&!a?b.IS(I):m;if(k&&a&&b.HB(I,m),0===A.length&&!a)return n()("div",{},void 0,C&&this.renderSearchFilters(),n()(N.B,{areaHeight:window.innerHeight}));const T=this.getActivityValues(A),x=this.stores.activityUpdatesStore.state,Z=0===x.filterActivityTypes.length&&void 0===x.filterDateRange.ending&&void 0===x.filterDateRange.starting,F=0===T.length&&!v&&a;return n()("div",{},void 0,C&&this.renderSearchFilters(),n()("div",{style:F?this.getPlaceholderContentStyle():this.getContentStyle(),className:F?"":"notranslate"},void 0,F?null===(l=(u=this.props).empty)||void 0===l?void 0:l.call(u,{hasFiltersOn:!Z}):null,n()("section",{role:"feed"},void 0,T.map(((e,t,i)=>{const s=i.length-1===t,a="notifications_tab"===o?{tab:"all",source:o}:{tab:"pageUpdatesSidebar",source:o};return(0,y.XI)()?n()(S.LazyActivityUpdate,{activity:e,rootStore:r,isLast:s,tabArgs:a},e.id):n()(S.LazyActivity,{activity:e,rootStore:r,isLast:s,tabArgs:a,useRedesignedIA:!1},e.id)}))),n()(D.Z,{onChange:e=>{e<200&&a&&!d&&v&&(Z||A.length>0)&&this.stores.activityUpdatesStore.update((e=>({...e,shouldLoadOlderActivities:!0})))}},void 0,!a&&v?this.renderSpinner(!0):null)))}})}renderSpinner(e){return n()("div",{style:this.getSpinnerStyle(e)},void 0,n()(P.Z,{}))}startMessageListeners(){const{navigableBlock:e,collectionId:t}=this.props,i=null==e?void 0:e.id;if(i){const e=(0,c.bS)(i);this.navigableBlockListenerReference=M.Z.addListener(e,this.handleNavigableBlockEmit,void 0,this.environment)}if(t){const e=(0,c.Cy)(t);this.collectionListenerReference=M.Z.addListener(e,this.handleCollectionEmit,void 0,this.environment)}}stopMessageListeners(){this.navigableBlockListenerReference&&(M.Z.removeListener(this.navigableBlockListenerReference,this.environment),this.navigableBlockListenerReference=void 0),this.collectionListenerReference&&(M.Z.removeListener(this.collectionListenerReference,this.environment),this.collectionListenerReference=void 0)}getActivityValue(e){const{currentUserStore:t,currentSpaceStore:i}=k.default.state;if(!t||!i)return;const o=(0,f.No)(i,e,i.id).getValue();return o&&!o.invalid?o:null}getActivityValues(e){return l.oA(e.map((e=>this.getActivityValue(e))))}getContentStyle(){return{minHeight:this.environment.device.isMobile?void 0:"75vh"}}getPlaceholderContentStyle(){const{device:e}=this.environment;return{...this.getContentStyle(),paddingTop:e.isMobile?64:void 0,minHeight:e.isMobile?void 0:220,display:"flex",textAlign:"center",alignItems:"center",justifyContent:"center",fontSize:14,color:this.theme.mediumTextColor,flexDirection:"column",flex:"1 1 0%"}}getSpinnerStyle(e){return{...this.getPlaceholderContentStyle(),minHeight:e?64:220}}getFilterDataForTracking(){var e,t;const{filterActivityTypes:i,filterDateRange:o}=this.stores.activityUpdatesStore.state;return{activityTypes:i,dateRange:{start:null===(e=o.starting)||void 0===e?void 0:e.start_date,end:null===(t=o.ending)||void 0===t?void 0:t.start_date}}}}H.displayName="ActivityUpdates";const z=(0,g.injectIntl)(H)},64536:(e,t,i)=>{i.r(t),i.d(t,{PageAnalyticsPageOptOut:()=>F,TopbarPageAnalyticsOptOutMenu:()=>Z,TopbarPageAnalyticsOptOutMenuStore:()=>x,pageAnalyticsMenu:()=>T});var o=i(23174),n=i.n(o),s=i(67294),a=i(480),r=i(86628),d=i(49085),l=i(83176),c=i(18442),p=i(5366),u=i(62967),g=i(74647),m=i(97627),v=i(19037),y=i(18514),f=i(80444),h=i(7011),b=i(73420),S=i(53437),M=i(72495),w=i(42402),C=i(55422),k=i(60526);const I=(0,p.defineMessages)({pageAnalyticsName:{id:"action.pageAnalytics.name",defaultMessage:"Page analytics"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},privacySettingsName:{id:"action.privacySettings.name",defaultMessage:"Privacy settings"}}),A=e=>{const t=e.blocks[0];if(!t)return!1;return(0,k.W2)({canEditPage:t.canEdit(),device:e.environment.device})},T=(0,u.MV)({key:"page analytics menu",displayName:I.pageAnalyticsName,analyticsName:I.pageAnalyticsName.defaultMessage,validators:[v.DF],svg:l.z,subActions:e=>[{key:"view analytics",render:e=>s.createElement(M.Z,e),actions:[(0,u.cN)({key:"view analytics",displayName:I.viewAnalyticsName,analyticsName:I.viewAnalyticsName.defaultMessage,svg:l.z,validators:[A],closeParentMenu:!0,action:()=>{g.handleSidebarButtonClick(e.environment,e.blocks[0],h.gY.Updates,"more_menu"),h.ZP.setState({...h.ZP.state,currentSubTab:h.uF.Analytics})}}),(0,u.cN)({key:"privacy settings",displayName:I.privacySettingsName,analyticsName:I.privacySettingsName.defaultMessage,svg:c.H,validators:[],closeParentMenu:!0,action:e=>{x.setState({isOpen:!0,rect:e.originRect})}})]}]}),x=d.default.createValue({isOpen:!1,rect:void 0}),Z=()=>{window.__c={n:"TopbarPageAnalyticsOptOutMenu"};const e=(0,a.O7)(),t=(0,r.VK)((()=>x.state.isOpen),[]),i=(0,r.VK)((()=>x.state.rect),[]),o=(0,r.VK)((()=>f.default.state.mainEditorCurrentBlockStore),[]);return o?n()(S.ZP,{popupType:e.device.isMobile?S.ZP.PopupType.SlideUp:S.ZP.PopupType.Popup,alignmentToOrigin:S.ZP.Alignment.Center,open:t,render:()=>n()("div",{style:{minWidth:360,padding:16}},void 0,n()(b.sg,{gap:16},void 0,n()("div",{style:{fontSize:16,fontWeight:500}},void 0,n()(p.FormattedMessage,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})),n()(F,{store:o}))),originRect:i,onDismiss:()=>x.setState({isOpen:!1,rect:void 0})}):null};function F(e){window.__c={n:"PageAnalyticsPageOptOut"};const t=(0,a.O7)(),i=(0,r.VK)((()=>{const e=f.default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),o=(0,r.VK)((()=>{const t=null==i?void 0:i.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[i,e.store.id]);return n()(C.Z,{type:"dropdown",currentOption:o?"do_not_record":"record",options:[{key:"record",label:n()(p.FormattedMessage,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:n()(p.FormattedMessage,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:i=>{"do_not_record"===i?m.kY(t,e.store.id):m.pu(t,e.store.id)},isMobile:t.device.isMobile,title:n()(p.FormattedMessage,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:n()(p.FormattedMessage,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>n()(w.Z,{external:!0,href:(0,y.UY)("guides.pageAnalytics")},void 0,e)}}),captionStyle:{maxWidth:270}})}},69054:(e,t,i)=>{i.d(t,{J:()=>re});var o=i(10434),n=i.n(o),s=i(23174),a=i.n(s),r=i(67294),d=i(74725),l=i(480),c=i(86628),p=i(24405),u=i(7057),g=i(42875);const m=(0,i(45238).I)("commentSidebarZero",{viewBox:"0 0 56 56",svg:a()("path",{d:"M13.1289 47.6641C13.9297 47.6641 14.4961 47.3516 15.4141 46.5508L21.8984 40.5938C23.0703 42.4297 25.1602 43.4258 27.9922 43.4258H36.3516L42.6602 48.8164C43.5195 49.5586 44.0273 49.9492 44.7305 49.9492C45.7461 49.9492 46.332 49.2266 46.332 48.0938V43.4258H47.4453C51.8398 43.4258 54.6328 40.8281 54.6328 36.2969V24.1289C54.6328 19.5977 51.8398 17 47.4453 17H43.9688V14.793C43.9688 9.83203 41.0781 7 36.0977 7H8.87109C4.00781 7 1 9.83203 1 14.793V32.4297C1 37.4102 4.00781 40.2422 8.87109 40.2422H11.4492V45.7695C11.4492 46.9609 12.0742 47.6641 13.1289 47.6641ZM13.7539 39.2461C13.7539 38.3867 13.2266 37.9766 12.543 37.9766H9.08594C5.43359 37.9766 3.42188 36.043 3.42188 32.293V14.9492C3.42188 11.2188 5.45312 9.26562 9.08594 9.26562H35.8828C39.5156 9.26562 41.5469 11.2188 41.5469 14.9492V17H27.9922C23.4414 17 20.8047 19.5977 20.8047 24.1289V36.3164C20.8047 36.9805 20.8438 37.6055 20.9609 38.1719L13.7539 44.9883V39.2461ZM44.0859 47.2148L38.1289 41.9023C37.4844 41.3359 37.0938 41.1602 36.2344 41.1602H28.168C25.0039 41.1602 23.207 39.4805 23.207 36.1797V24.2656C23.207 20.9648 25.0039 19.2656 28.168 19.2656H47.25C50.4336 19.2656 52.2305 20.9648 52.2305 24.2656V36.1602C52.2305 39.4609 50.4336 41.1602 47.25 41.1602H45.2383C44.5938 41.1602 44.0859 41.5312 44.0859 42.3711V47.2148Z"})});var v=i(72126),y=i(80503),f=i(82990),h=i(5366),b=i(54564),S=i(96514),M=i(43250),w=i(78089),C=i(33929),k=i(65598),I=i(77546),A=i(45094),T=i(34859),x=i(80444),Z=i(24229),F=i(29798),P=i(7011),_=i(32163),D=i(53336),B=i(36591),R=i(42853),O=i(74647),U=i(4708),L=i(50141),V=i(81258),K=i(52275),E=i(89728),N=i(53437),H=i(72495),z=i(64921);function G(){window.__c={n:"UpdateSidebarTabCommentsSegmentedControl"};const e=(0,c.VK)((()=>P.ZP.state.commentsMode),[]),t=(0,p.yK)((e=>({container:{background:e.buttonHoveredBackground,width:"calc(100% - 32px)",height:36,borderRadius:10,display:"flex",margin:"10px 16px 6px 16px",marginTop:20,padding:4,gap:2,pointerEvents:"auto"},defaultButton:{borderRadius:8,fontSize:13,fontWeight:f.Z.fontWeight.medium,textAlign:"center",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",lineHeight:1.8,color:e.regularTextColor,letterSpacing:-.08},selectedButton:{fontWeight:f.Z.fontWeight.semibold,background:e.segmentedControlActiveBackground,border:`0.5px solid ${e.outlineButtonBorder}`}})),[]);return a()("div",{style:t.container,className:M.rG8},void 0,a()(z.Z,{style:{...t.defaultButton,...e===P.F7.Unresolved?t.selectedButton:{}},onClick:()=>{O.setUpdateSidebarCommentsMode(P.F7.Unresolved)}},void 0,a()("span",{},void 0,a()(h.FormattedMessage,{id:"updateSidebarTabCommentsSegmentedControl.option.open",defaultMessage:"Open"}))),a()(z.Z,{style:{...t.defaultButton,...e===P.F7.Resolved?t.selectedButton:{}},onClick:()=>{O.setUpdateSidebarCommentsMode(P.F7.Resolved)}},void 0,a()("span",{},void 0,a()(h.FormattedMessage,{id:"updateSidebarTabCommentsSegmentedControl.option.resolved",defaultMessage:"Resolved"}))))}const W=[P.F7.Unresolved,P.F7.Resolved],$={[P.F7.Unresolved]:M.oc0,[P.F7.Resolved]:M.Y7r},j=(0,h.defineMessages)({[P.F7.Unresolved]:{id:"updateSidebar.comments.mode.unresolvedOption",defaultMessage:"Open comments"},[P.F7.Resolved]:{id:"updateSidebar.comments.mode.resolvedOption",defaultMessage:"Resolved comments"}}),Y=(0,h.defineMessages)({[P.F7.Unresolved]:{id:"updateSidebar.comments.filter.button.unresolvedMode",defaultMessage:"Open"},[P.F7.Resolved]:{id:"updateSidebar.comments.filter.button.resolvedMode",defaultMessage:"Resolved"}});function q(){window.__c={n:"UpdateSidebarCommentsFilterControl"};return(0,l.O7)().device.isMobile?a()(G,{}):a()(X,{})}function X(){window.__c={n:"DesktopUpdateSidebarCommentsFilterControl"};const[e,t]=(0,r.useState)(!1),{commentsMode:i}=(0,c.Kw)(P.ZP),o=(0,c.VK)((()=>x.default.state.mainEditorCurrentBlockStore),[]),s=(0,c.VK)((()=>(0,U.gE)()),[]),d=(0,p.yK)((e=>({container:{display:"flex",flexDirection:"column"},commentsHeader:{display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`,alignItems:"center",pointerEvents:"auto"},label:{fontSize:14,color:e.regularTextColor,fontWeight:f.Z.fontWeight.medium,display:"flex",alignItems:"center",padding:"12px 12px 12px 16px"},toggleButton:{justifyContent:"center",display:"flex",color:e.mediumTextColor},toggleButtonContainer:{paddingLeft:12,paddingRight:8,display:"flex"},chevronIcon:{width:10,marginLeft:4,fill:e.lightIconColor},getNotifiedContainer:{paddingRight:6,paddingLeft:6}})),[]),l=(0,r.useCallback)((()=>a()(_.Z,{type:_.i.Vertical,initialFocus:void 0,sections:[{key:"commentFilter",render:e=>r.createElement(H.Z,e),items:W.map((e=>({key:e,render:t=>r.createElement(K.Z,n()({},t,{className:$[e],title:C.default.formatMessage(j[e]),right:a()("div",{style:{width:14,opacity:i===e?1:0}},void 0,(0,B.e)())})),action:()=>{O.setUpdateSidebarCommentsMode(e),t(!1)}})))}]})),[i]);return r.createElement(r.Fragment,null,a()("div",{style:d.container},void 0,"variant_2"===s&&o&&a()("div",{style:d.getNotifiedContainer},void 0,a()(L.n,{navigableBlock:o,from:"comments_tab",buttonPopupStore:V.Z})),a()("div",{style:d.commentsHeader,className:M.I9j},void 0,a()("div",{style:d.label},void 0,a()(h.FormattedMessage,{id:"updateSidebar.header.commentsLabel",defaultMessage:"Comments"})),a()("div",{style:d.toggleButtonContainer,className:M.CBT},void 0,a()(N.ZP,{popupType:N.ZP.PopupType.Popup,open:e,origin:a()(E.Z,{style:d.toggleButton,onClick:()=>{t(!0)}},void 0,C.default.formatMessage(Y[i]),(0,R.i)(d.chevronIcon)),placementToOrigin:N.ZP.Placement.Bottom,alignmentToOrigin:N.ZP.Alignment.Center,originGap:4,render:l,onDismiss:()=>{t(!1)}})))))}var Q=i(21202),J=i(77907),ee=i(35973),te=i(57559),ie=i(28992);const oe=r.forwardRef(((e,t)=>{window.__c={n:"UpdateSidebarDiscussionItem"};const{currentBlockStore:i,discussion:o,showAllRepliesAfterTimestamp:n,focused:s,isLast:d,location:u}=e,g=(0,c.VK)((()=>Z.Z.state.open&&Z.Z.state.discussionIds||[]),[]),m=(0,l.O7)();(0,r.useEffect)((()=>{var e;if(s){ee.Z.setState({source:"update_sidebar",discussionIds:[o.id]});const e=setTimeout((()=>{var e;(null===(e=ee.Z.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0])===o.id&&S.AM([o.id])}),1500);return()=>{clearTimeout(e)}}(null===(e=ee.Z.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0])===o.id&&ee.Z.setState({discussionIds:[]})}),[s,o,m]);const v=(0,c.VK)((()=>{var e;return(null===(e=ee.Z.state)||void 0===e?void 0:e.discussionIds)||[]}),[]),y=o.id,{parentId:f,currentSpaceId:h}=(0,c.VK)((()=>({parentId:o.getParentId(),currentSpaceId:o.getSpaceId()})),[o]),b=f?te.G.createChildStore(o,{table:Q.iU,id:f}):void 0,C=g.includes(y),k=v.includes(y),I=(0,p.yK)((e=>({discussionContainer:{paddingTop:m.device.isMobile?4:10,borderBottom:d||m.device.isMobile?void 0:`1px solid ${e.regularDividerColor}`,transition:"background 300ms ease"},replyButton:{color:e.blueColor,marginLeft:23,fontSize:14},hoveredStyle:{background:"sidebar"===u?e.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===u?e.focusDiscussionBackground:void 0}})),[u,d,m]);if(!b||!h)return null;const A=r.createElement("div",{className:`sidebar-discussion-${y} ${M.s$o}`,onClick:e.onClick,onMouseEnter:e.onMouseEnter,ref:t,style:{...I.discussionContainer,...s||k?I.hoveredStyle:{},...C?I.pressedStyle:{}}},a()(J.LazyDiscussion,{store:o,blockStore:i,format:w.O2.Sidebar,isFirst:!1,isOnly:!1,showResolveButtonByDefaultIfPossible:!1,discussionLocation:"updates_sidebar",showAllRepliesAfterTimestamp:n}));return a()(ie.Z,{allowTextSelection:!0,title:A,style:{marginLeft:-14,marginRight:-14,width:"calc(100% + 28px)",lineHeight:void 0,cursor:"pointer"}})}));function ne(e){window.__c={n:"UpdateSidebarDiscussionSection"};const{firstItemId:t}=e,i=(0,c.VK)((()=>{var e;return null===(e=ee.Z.state)||void 0===e?void 0:e.discussionIds.some((e=>e===t))}),[t]),o=(0,c.VK)((()=>Z.Z.state.open&&Z.Z.state.discussionIds&&Z.Z.state.discussionIds.some((e=>e===t))),[t]),s=(0,p.yK)((t=>({hoveredStyle:{background:"sidebar"===e.location?t.hoveredDiscussionBackground:void 0},pressedStyle:{background:"sidebar"===e.location?t.focusDiscussionBackground:void 0},basicDesktopTitleStyle:{paddingLeft:16,paddingTop:16,marginBottom:0,marginTop:0,fontSize:12,transition:"background 300ms ease"},mobileTitleStyle:{fontSize:13,fontWeight:f.Z.fontWeight.medium,paddingBottom:0,textTransform:"unset",marginTop:-12}})),[e.location]);return r.createElement(H.Z,n()({desktopTitleStyle:{...s.basicDesktopTitleStyle,...i?s.hoveredStyle:{},...o?s.pressedStyle:{}},mobileTitleStyle:s.mobileTitleStyle,disableDesktopPadding:!0,disableMobileBorders:!0},e))}var se=i(70268);const ae=new F.Z;function re(e){window.__c={n:"UpdateSidebarTabComments"};const{timeMounted:t,location:i}=e,o=(0,l.O7)(),[s,F]=(0,r.useState)(!1),B=(0,c.VK)((()=>x.default.state.mainEditorCurrentBlockStore),[]),R=(0,c.VK)((()=>o.currentUser.id),[o]),O=(0,c.VK)((()=>(0,w.DF)({blockStore:B,ignoreAfterTime:t,currentUserId:R})),[B,t,R]),[U]=(0,c.AF)(P.ZP),L=(0,c.VK)((()=>(0,A._c)(o)),[o]),V=(0,c.VK)((()=>Z.Z.state.open&&Z.Z.state.discussionIds||[]),[]),{resolved:K,unresolved:E}=(0,c.VK)((()=>(0,k.bB)(O)),[O]),N=U.commentsMode===P.F7.Unresolved,H=N?E:K,z=H.map((e=>e.id));(0,r.useEffect)((()=>{if("popup"===i&&s)return()=>{S.AM(z)}}),[i,z,s]);const G=(0,p.yK)((e=>({commentsEmptyStyle:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",background:e.contentBackground,marginRight:L?2:0,pointerEvents:"auto",paddingTop:10},commentsContentStyle:{position:"relative",minHeight:0,display:"flex",flexDirection:"column",background:e.contentBackground,marginRight:L?2:0,pointerEvents:"auto",height:"100%"},commentsIconStyle:{height:54,width:54,marginBottom:12,fill:e.mediumIconColor}})),[L]),W=(0,r.useRef)(null),$=(0,c.VK)((()=>(0,A.Sx)(o)),[o]);(0,d.O)({active:$,closeHandler:b.LZ,ref:W});const j=(0,c.VK)((()=>{const e=v.vM(H,(e=>{const t=(0,w.Qg)({recordStore:e,currentUserId:R});return t?(0,u.$6)(t.getCreatedTime()):""}));return delete e[""],e}),[H,R]),Y=(0,c.VK)((()=>(0,w.W5)(H)),[H]);if((0,r.useEffect)((()=>{s||Y||F(!0)}),[s,Y]),!B||!j||!s)return a()(se.B,{areaHeight:window.innerHeight});if(0===H.length)return a()("div",{style:G.commentsContentStyle},void 0,a()(q,{}),a()("div",{style:G.commentsEmptyStyle},void 0,m(G.commentsIconStyle),a()("div",{style:{fontWeight:f.Z.fontWeight.semibold,marginBottom:4}},void 0,a()(h.FormattedMessage,N?{id:"updateSidebar.commentContainer.emptyTitleUnresolved",defaultMessage:"No open comments yet"}:{id:"updateSidebar.commentContainer.emptyTitleResolved",defaultMessage:"No resolved comments yet"})),a()("div",{style:{width:200,alignSelf:"center"}},void 0,a()(h.FormattedMessage,N?{id:"updateSidebar.commentContainer.emptyUnresolved",defaultMessage:"Open comments on this page will appear here"}:{id:"updateSidebar.commentContainer.emptyResolved",defaultMessage:"Resolved comments on this page will appear here"}))));const X=Object.keys(j).sort().reverse(),Q=X.map(((e,s)=>{const a=(0,u.ZV)({value:{type:"date",start_date:e},date_format:"relative",userTimeZone:(0,g.r)(),intl:C.default.getIntl(),allowRelativeDates:!0}),d=j[e];return{key:e,render:e=>r.createElement(ne,n()({title:a,firstItemId:d[0].id,location:i},e)),items:d.map(((e,a)=>({key:e.id,render:o=>r.createElement(oe,n()({},o,{currentBlockStore:B,discussion:e,isFirstInSection:0===a,location:i,isLast:a===d.length-1&&s===X.length-1,showAllRepliesAfterTimestamp:t})),action:()=>{S.en({discussionId:e.id,currentBlockStore:B,environment:o,analyticsFrom:"updates_sidebar",currentEl:W.current})}})))}})),J=Q.flatMap((e=>e.items)).findIndex((e=>V.includes(e.key.toString())));return r.createElement("div",{style:G.commentsContentStyle,ref:W},a()(q,{}),a()(D.Z,{type:T.Z.Y,style:{flexGrow:1,minHeight:0,transform:"translateZ(0px)",zIndex:1,overflow:"hidden auto",marginBottom:0},className:M.Xsh},void 0,a()(_.Z,{disableKeyboard:!0,store:ae,type:_.i.Vertical,initialFocus:J>=0?J:void 0,scrollElIntoView:e=>{if(e instanceof Element){const t=e.getBoundingClientRect(),i=y.R6(o.device.isElectronMac),n=window.innerHeight,s=i+50,a=n-s;if(t.height>=a)return;const r=t.top>=s&&t.top<=n,d=r&&t.bottom>=n,l=t.bottom>=s&&t.bottom<=n,c=l&&t.top-s<0,p=r||l,u=.4*t.height;d&&Math.abs(t.top-n)<u?(0,I.Wr)(e,{edgeDist:n-t.height-s,animate:!0}):c&&Math.abs(t.bottom-s)<u?(0,I.Wr)(e,{edgeDist:0,animate:!0}):p||(0,I.Wr)(e,{edgeDist:0,animate:!0})}},sections:Q})))}},93481:(e,t,i)=>{i.d(t,{Z:()=>I});var o=i(23174),n=i.n(o),s=i(67294),a=i(83355),r=i(69651),d=i(97880),l=i(5366),c=i(65496),p=i(41558),u=i(33338),g=i(42922),m=i(52275),v=i(3386),y=i(89728),f=i(53437),h=i(72495),b=i(83264),S=i(255),M=i(75689),w=i(91642),C=i(8319);class k extends a.Z{constructor(){super(...arguments),this.storeTypes={store:p.Z},this.renderActiveButtonOrigin=()=>{const{value:e,dateFormat:t,disabled:i,focused:o,intl:s}=this.props,a=this.styles,d=this.getThemeColors(),l={...a.menuItem,...d.activeMenuItem},p=c._Q(e,s,t),u=n()(S.Z,{onClick:this.handleClear,disabled:i});return n()(m.Z,{focused:o,disabled:i,icon:(0,r.C)(a.iconActiveDesktop),title:p,right:u,isTokenTitle:!0,alignIconTop:!0,onClick:this.handleOriginActivate,desktopTitleStyle:a.menuItemTitleDesktop,desktopIconStyle:a.iconActiveDesktopWrapper,style:l})},this.renderInactiveButtonOrigin=()=>{const{title:e,icon:t,disabled:i,focused:o,mode:s}=this.props,a=this.styles,r=this.getThemeColors(),d={...a.menuItem,...r.buttonMenuItem,...s===C.Z.Mode.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return n()(m.Z,{focused:o,disabled:i,icon:t(a.icon),title:e,onClick:this.handleOriginActivate,style:d})},this.renderPillButtonOrigin=()=>{const{value:e,title:t}=this.props;return n()(u.Z,{on:Boolean(e.starting||e.ending),icon:(0,r.C)({width:16,marginRight:6,fill:"currentColor"}),title:n()("span",{},void 0,t),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e,showButtons:t}=this.props,{store:i}=this.stores;return s.createElement(s.Fragment,null,n()(b.Z,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:i,onDismiss:this.handleMenuClose}),t&&n()("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"}},void 0,n()(y.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleMenuClose},void 0,n()(l.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})),n()(g.Z,{onClick:()=>this.props.onChange(this.stores.store.state.temporaryDateRange)},void 0,n()(l.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"}))))},this.renderFooter=()=>{const{store:e}=this.stores;return n()(h.Z,{topBorder:!0,style:{padding:6,justifyContent:"space-between",display:"flex"}},void 0,n()(y.Z,{onClick:()=>{e.setState({...e.state,temporaryDateRange:{starting:void 0,ending:void 0}}),this.props.onChange({})}},void 0,n()(l.FormattedMessage,{id:"searchDateFilter.clearButton",defaultMessage:"Clear"})),n()(g.Z,{onClick:this.handleMenuClose},void 0,n()(l.FormattedMessage,{id:"searchDateFilter.applyButton",defaultMessage:"Apply"})))},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t}=this.stores;e||t.setState({...t.state,isOpen:!0,focus:"starting"})},this.handleMenuClose=e=>{const{onChange:t,onMenuDismiss:i}=this.props,{store:o}=this.stores,{temporaryDateRange:n}=o.state;c.zD(e)||(this.props.showButtons||t(n),o.setState({...o.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),i&&i())},this.handleClear=()=>{const{onChange:e}=this.props;e({starting:void 0,ending:void 0})},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t}=this.stores;if(!e.error)return t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},sectionMenuItem:{display:"flex"},summary:{display:"inline-flex"}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t}=this.props,{store:i}=this.stores,o=this.styles,s=e===C.z.Section,a=s?t:void 0,r=(()=>e===C.Z.Mode.Section?this.renderActiveButtonOrigin():e===C.Z.Mode.Button?this.renderInactiveButtonOrigin():e===C.Z.Mode.Pill?this.renderPillButtonOrigin():void(0,d.t1)(e))();return n()(w.Z,{title:a,marginAfter:s},void 0,n()(v.Z,{capture:i.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey},void 0,n()(f.ZP,{popupType:this.getPopupType(),open:i.state.isOpen,origin:r,render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Start,keepFocus:!0,style:o.popup})))}renderMobile(e){const{store:t}=this.stores,i=e===C.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return n()(f.ZP,{popupType:f.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:i,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:i}=this.props,o=this.styles;return n()(m.Z,{disabled:i,focused:!1,icon:e(o.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,dateFormat:i,disabled:o,intl:s}=this.props,a=this.styles,d=n()("div",{style:a.summary},void 0,(0,r.C)(a.iconActiveMobile),c._Q(t,s,i));return n()(M.Z,{disabled:o,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:d})}getCurrentValue(){const{value:e}=this.props,{store:t}=this.stores,{temporaryDateRange:i}=t.state;return{...e,...i}}getPopupType(){const{device:e}=this.environment;return e.isMobile?f.ZP.PopupType.SlideUp:f.ZP.PopupType.Popup}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},activeMenuItem:{color:this.theme.regularTextColor}}}}k.displayName="SearchDateFilter";const I=(0,l.injectIntl)(k)},67579:(e,t,i)=>{i.d(t,{f:()=>S});var o=i(10434),n=i.n(o),s=i(23174),a=i.n(s),r=i(67294),d=i(24405),l=i(69651),c=i(73123),p=i(33929),u=i(87279),g=i(33338),m=i(52275),v=i(78140),y=i(32163),f=i(53437),h=i(72495),b=i(91642);function S(e){window.__c={n:"DateFilter"};const t=(0,d.yK)((e=>({popup:{width:125,marginLeft:5},pillStyle:{display:"flex",alignItems:"center"}})),[]),{currentFilter:i,hideAllTime:o}=e,[s,S]=(0,r.useState)(!1),M=c.Hz.filter((e=>!o||"all_time"!==e)).map((t=>{const i=()=>{e.onChangeFilter(t),S(!1)};return{key:t,action:()=>{},render:()=>a()(m.Z,{focused:!1,onClick:i,title:p.default.formatMessage(c.Rh[t])})}})),w=a()(g.Z,{on:Boolean(i),wrapStyle:t.pillStyle,icon:(0,l.C)({width:16,marginRight:6,fill:"currentColor"}),title:p.default.formatMessage(c.Rh[i]),onClick:()=>{S(!0)}}),C=[{key:"filters",items:M,render:e=>r.createElement(h.Z,n()({},e,{title:null,loading:!1}))}],k=a()(v.Z,{menuType:u.og.Popup,header:null},void 0,a()(y.Z,{type:y.i.Vertical,initialFocus:0,sections:C}));return a()(b.Z,{marginAfter:!1},void 0,a()(f.ZP,{popupType:f.ZP.PopupType.Popup,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Start,open:s,render:()=>k,onDismiss:()=>S(!1),keepFocus:!0,origin:w,preventScaleTransition:!0,style:t.popup}))}},35314:(e,t,i)=>{i.d(t,{e:()=>a});var o=i(67294),n=i(86628),s=i(77794);function a(){const[e,t]=(0,o.useState)(0),[i]=(0,o.useState)((()=>new s.E)),a=(0,o.createRef)();return(0,o.useEffect)((()=>{a.current&&i.observe(a.current)}),[a,i]),(0,n.VK)((()=>{e!==i.rect.state.width&&t(i.rect.state.width)}),[e,i.rect]),[a,e]}},50141:(e,t,i)=>{i.d(t,{n:()=>Z});var o=i(23174),n=i.n(o),s=i(67294),a=i(86628),r=i(24405),d=i(82990),l=i(5366),c=i(4708),p=i(10434),u=i.n(p),g=i(480),m=i(90792),v=i(42853),y=i(62967),f=i(19719),h=i(48019),b=i(31945),S=i(78140),M=i(89728),w=i(72495),C=i(87279),k=i(98742),I=i(77080),A=i(24764),T=i(57538);function x(e){var t;window.__c={n:"GetNotifiedDropdown"};const{blockStore:i,from:o,buttonPopupStore:l}=e,p=e.moreProminentStyling??!1,x=(0,g.O7)(),Z=(0,a.VK)((()=>i.isPageBlock()),[i]),F=(0,a.VK)((()=>i.getFollowSettingsKey()),[i]),P=(0,a.VK)((()=>(0,c.m7)()),[]),_=(0,s.useCallback)((()=>f.Z8({environment:x,pageId:i.pointer.id,isCurrentlyFollowing:(0,T.Z)(F).following,from:"page_updates"===o?"page_updates":void 0})),[i.pointer.id,x,F,o]),D=(0,a.VK)((()=>I.default.checkGate("property_updates_notifications")?A.CA({followSettingsKey:F,environment:x,blockStore:i,from:o,useCopyChanges:P}):A.Zk({followSettingsKey:F,environment:x,blockStore:i,from:o})),[F,x,i,o,P]),B=(0,r.yK)((e=>({buttonContainer:{display:"flex",alignItems:"center",color:e.mediumTextColor,padding:p?"4px 10px":4,borderRadius:3,marginRight:p?0:4,fontSize:d.Z.fontSize.UIRegular.desktop},bellIcon:{width:14,height:14,marginRight:4},chevronIcon:{marginLeft:4,width:10,height:10},spacer:{flexGrow:1},footerLabel:{padding:12,backgroundColor:e.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${e.regularDividerColor}`,marginTop:1}})),[p]),R=null===(t=D.find((e=>A.t0({key:e.action.analyticsName,userSelectedKey:F}))))||void 0===t?void 0:t.title;return Z?n()(b.ZP,{popupType:b.Z4.Popup,alignmentToOrigin:b.vR.End,placementToOrigin:b.pO.Bottom,sameWidthAsOrigin:p,buttonPopupStore:l,render:e=>n()(S.Z,{menuType:C.og.Popup,minWidth:290,maxHeight:"50vh"},void 0,n()(h.Z,{context:{blocks:[],environment:x,publicEditMode:void 0},sections:[(0,y.$J)({key:"in-app-notifications-section",render:e=>s.createElement(w.Z,e),actions:D.map((e=>e.action))})],initialFocus:void 0,onAccept:()=>e.close()})),renderOrigin:e=>s.createElement(M.Z,u()({},(0,k.Z)(e,{onClick:_}),{style:B.buttonContainer}),(0,m.t)(B.bellIcon),R,p&&n()("div",{style:B.spacer}),(0,v.i)(B.chevronIcon))}):null}function Z(e){window.__c={n:"GetNotifiedFor"};const{navigableBlock:t,from:i,buttonPopupStore:o}=e,s=(0,a.VK)((()=>(0,c.m7)()),[]),p=(0,a.VK)((()=>t.isPageBlock()),[t]),u=(0,r.yK)((e=>({label:{fontSize:d.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,fontWeight:d.Z.fontWeight.medium},container:{padding:"12px 8px 8px 10px"},border:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:3,marginTop:8}})),[]);return p?n()("div",{style:u.container},void 0,n()("div",{style:u.label},void 0,n()(l.FormattedMessage,s?{id:"UpdateSidebarTabUpdatesHeader.pageNotificationSettings.label",defaultMessage:"Page notification settings"}:{id:"UpdateSidebarTabUpdatesHeader.getNotifiedButton.label",defaultMessage:"Get notified for"})),n()("div",{style:u.border},void 0,n()(x,{blockStore:t,moreProminentStyling:!0,from:i,buttonPopupStore:o}))):null}},24764:(e,t,i)=>{i.d(t,{t0:()=>A,Zk:()=>k,CA:()=>C});var o=i(10434),n=i.n(o),s=i(23174),a=i.n(s),r=i(67294),d=i(45433),l=i(98519),c=i(97880),p=i(5366),u=i(62967),g=i(57883),m=i(50906),v=i(9953),y=i(39699);function f(e){const{environment:t,key:i,selectedKey:o,following:n,followSettings:s,navigableBlockId:a,userId:r,spaceId:d,from:l}=e;y.createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{v.Ue({environment:e.environment,table:g.t0,args:{following:n,followSettings:s,navigableBlockId:a,userId:r,spaceId:d},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),n?m.RJe(t,{from:"page_updates"}):m.ubm(t,{from:"page_updates"}),o!==i&&m.kLN(t,{from:l,navigableBlockId:a,oldSetting:o,newSetting:i})}var h=i(64964),b=i(93405),S=i(64369),M=i(80444),w=i(57538);function C(e){const{followSettingsKey:t,environment:i,blockStore:o,from:n,useCopyChanges:s}=e,r=I({key:"none",selectedKey:t,title:a()(p.FormattedMessage,s?{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}:{id:"GetNotifiedDropdown.mentionsAndReplies.label",defaultMessage:"Only replies and @mentions"}),environment:i,blockStore:o,from:n}),l=I({key:"comments",selectedKey:t,title:a()(p.FormattedMessage,s?{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}:{id:"GetNotifiedDropdown.allUpdatesComments.label",defaultMessage:"All updates"}),caption:s?void 0:a()(p.FormattedMessage,{id:"GetNotifiedDropdown.allComments.caption",defaultMessage:"All comments and @mentions"}),environment:i,blockStore:o,from:n}),c=I({key:"all",selectedKey:t,title:a()(p.FormattedMessage,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:a()(p.FormattedMessage,s?{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}:{id:"GetNotifiedDropdown.allUpdates.caption",defaultMessage:"All comments, @mentions, and property changes"}),environment:i,blockStore:o,from:n}),u=o.getAssociatedCollectionStore();if(!u)return[l,r];const g=u.getDatabaseType();if(g===d.GL.tasks){return[c,I({key:"important",selectedKey:t,title:a()(p.FormattedMessage,s?{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesTasks.label",defaultMessage:"Only important updates"}),caption:a()(p.FormattedMessage,s?{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesTasks.caption",defaultMessage:"All comments, @mentions, and changes to Status, Assignee, or Due Date"}),environment:i,blockStore:o,from:n}),r]}if(g===d.GL.projects){return[c,I({key:"important",selectedKey:t,title:a()(p.FormattedMessage,s?{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesProjects.label",defaultMessage:"Only important updates"}),caption:a()(p.FormattedMessage,s?{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}:{id:"GetNotifiedDropdown.onlyImportantUpdatesProjects.caption",defaultMessage:"All comments, @mentions, and changes to Status or Date"}),environment:i,blockStore:o,from:n}),r]}return[c,I({key:"comments",selectedKey:t,title:a()(p.FormattedMessage,s?{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}:{id:"GetNotifiedDropdown.onlyComments.label",defaultMessage:"Only comments"}),caption:s?void 0:a()(p.FormattedMessage,{id:"GetNotifiedDropdown.onlyComments.caption",defaultMessage:"All comments and @mentions"}),environment:i,blockStore:o,from:n}),r]}function k(e){const{followSettingsKey:t,environment:i,blockStore:o,from:n}=e;return[I({key:"important",selectedKey:t,title:a()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.label",defaultMessage:"All comments"}),caption:a()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.caption",defaultMessage:"Notified of all comments and @mentions"}),environment:i,blockStore:o,from:n}),I({key:"none",selectedKey:t,title:a()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.label",defaultMessage:"Replies and @mentions"}),caption:a()(p.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.caption",defaultMessage:"Notified of comment replies and @mentions"}),environment:i,blockStore:o,from:n})]}function I(e){const{key:t,title:i,caption:o,selectedKey:s,environment:d,blockStore:c,from:p}=e,g=A({key:t,userSelectedKey:s}),m={icon:{width:14,height:14},rightWrapper:o?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,u.cN)({key:t,displayName:void 0,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=M.default.state;if(e){const{following:i,followSettings:o}=(0,w.Z)(t),n=e.id,a=c.id,r=c.getSpaceId();f({environment:d,following:i,followSettings:o,navigableBlockId:a,spaceId:r,userId:n,from:p,key:t,selectedKey:s}),"inbox"!==p&&"more_menu"!==p||h.d4({item:{label:T(t)},undoFunc:()=>{const{following:e,followSettings:i}=(0,w.Z)(s);f({environment:d,following:e,followSettings:i,navigableBlockId:a,spaceId:r,userId:n,from:p,key:t,selectedKey:s})}})}},render:e=>r.createElement(b.Z,n()({},e,{title:a()(S.Z,{},void 0,i),caption:o,shouldWrapCaption:!0,right:g?(0,l.k)(m.icon):a()("div",{style:m.icon}),rightStyle:m.right}))}),title:i,isSelectedOption:g}}function A(e){const{key:t,userSelectedKey:i}=e;return"important"===i||"comments"===i?"important"===t||"comments"===t:t===i}function T(e){switch(e){case"none":return a()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return a()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return a()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return a()(p.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,c.t1)(e)}}},88144:(e,t,i)=>{i.r(t),i.d(t,{GetNotifiedFor:()=>o.n,TopbarUpdatesMenu:()=>I,UpdateSidebar:()=>$e});var o=i(50141),n=i(10434),s=i.n(n),a=i(23174),r=i.n(a),d=i(67294),l=i(86628),c=i(24405),p=i(5366),u=i(84708),g=i(78140),m=i(480),v=i(80503),y=i(82990),f=i(43250),h=i(81258);const b=new(i(61766).Z);var S=i(7011),M=i(66957);function w(){return r()(p.FormattedMessage,{id:"updateSidebar.header.updatesLabel",defaultMessage:"Updates"})}function C(e){window.__c={n:"UpdateSidebarTabUpdatesHeader"};const t=(0,m.O7)(),{enablePageAnalytics:i,popOutMode:n,navigableBlock:s,inPeekView:a}=e,d=(0,c.yK)((e=>({updatesHeaderStyle:{position:"relative",pointerEvents:"auto",marginTop:n?0:v.R6(t.device.isElectronMac),paddingTop:4,width:n&&!a?"calc(100% - 2px)":"100%",background:a?e.popoverBackground:e.contentBackground,padding:"12px 12px 12px 16px",borderBottom:`1px solid ${e.regularDividerColor}`},label:{fontSize:14,color:e.regularTextColor,fontWeight:y.Z.fontWeight.medium}})),[n,t,a]),u=(0,l.VK)((()=>S.ZP.state.currentSubTab),[]),g=a?b:h.Z;return r()("div",{style:{...d.updatesHeaderStyle,...i?{padding:"0 6px"}:{}},className:f.cFM},void 0,r()(o.n,{navigableBlock:s,from:"page_updates",buttonPopupStore:g}),i?r()(M.Z,{tabs:[r()(w,{},"updates"),r()(p.FormattedMessage,{id:"updateSidebar.header.analyticsLabel",defaultMessage:"Analytics"},"analytics")],selectedIndex:u,onChange:e.onTabChange,style:{...d.label,padding:0,boxShadow:"none"},tabStyle:{padding:"12px 0"}}):r()("div",{style:d.label},void 0,r()(w,{})))}var k=i(87279);function I(e){window.__c={n:"TopbarUpdatesMenu"};const{blockStore:t,spaceStore:i}=e,o=function(e){const{spaceStore:t,blockStore:i}=e,o=(0,l.VK)((()=>{var e,t;return(null==i||null===(e=i.getModel())||void 0===e?void 0:e.isCollectionView())?null===(t=i.getCollectionPointer())||void 0===t?void 0:t.id:void 0}),[i]);if(!t)return;const n=i.id,s=t.id;return{navigableBlockId:n,collectionId:o,spaceId:s}}({blockStore:t,spaceStore:i});return o?r()(g.Z,{menuType:k.og.Popup,className:f.KLh,header:r()(C,{navigableBlock:t,enablePageAnalytics:!1,popOutMode:!0,inPeekView:!0})},void 0,d.createElement(u.Z,s()({key:t.id,empty:()=>r()(A,{}),source:"updates_sidebar",navigableBlock:t},o))):null}function A(){window.__c={n:"EmptyState"};const e=(0,c.yK)((e=>({container:{marginTop:64,textAlign:"center",paddingLeft:18,paddingRight:18,marginBottom:64},content:{fontSize:14,color:e.mediumTextColor,marginTop:4}})),[]);return r()("div",{style:e.container},void 0,r()("div",{style:e.content},void 0,r()("span",{},void 0,r()(p.FormattedMessage,{defaultMessage:"No edits in this page yet.",id:"topbar.updatesButton.emptyState"}))))}var T=i(74725),x=i(97880),Z=i(51454),F=i(50906),P=i(74647),_=i(81598),D=i(23063),B=i(3553),R=i(55064),O=i(70268),U=i(69054),L=(i(21703),i(30120)),V=i(45010),K=i(45094),E=i(34859),N=i(80444),H=i(53336),z=i(30251),G=i(13991),W=i(7057),$=i(53877),j=i(83176),Y=i(82855),q=i(16880),X=i(84169),Q=i(18442),J=i(72126),ee=i(32056),te=i(54368),ie=i(77420),oe=i(19889),ne=i(62965),se=i(16287),ae=i(54642),re=i(25320),de=i(83420),le=i(20095),ce=i(65598),pe=i(18514),ue=i(41168),ge=i(35314),me=i(77907),ve=i(44904),ye=i(57559),fe=i(31945),he=i(73420),be=i(68785),Se=i(63296),Me=i(70301),we=i(64369),Ce=i(45653),ke=i(67579),Ie=i(64536);const Ae=Date.now();function Te(e){let{store:t,spaceId:i,isDisabledForWorkspace:o}=e;window.__c={n:"PageAnalytics"};const[n,s]=(0,d.useState)("last_28_days"),[a,u]=(0,d.useState)({state:o?"disabled-for-workspace":"loading"}),v=(0,m.O7)(),y=(0,c.Fg)(),f=(0,l.VK)((()=>{const{currentSpaceStore:e}=N.default.state;return null==e?void 0:e.getName()}),[]),h=(0,l.VK)((()=>{switch(n){case"last_7_days":return 7;case"last_28_days":return 28;case"last_90_days":return 90;case"all_time":return}}),[n]);(0,d.useEffect)((()=>{o||async function(){const e=await ae.getPageAnalytics(v,{pageId:t.id,spaceId:i,days:h});if("failed"===e.type)return void u({state:"empty"});const o=e.data.map((e=>{let{ds:t,total_views:i,unique_views:o}=e;return{ds:t,values:{total_views:i,unique_views:o}}}));o.filter((e=>{let{ds:t}=e;return $.OQ.isoToUnixMs(t,"UTC")??Ae<=Ae})).every((e=>{let{values:t}=e;return 0===t.total_views}))?u({state:"empty"}):u({state:"loaded",data:o})}()}),[v,t.id,o,i,h]);const b=(0,c.yK)((e=>({fullHeight:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},spinner:{width:32,height:32}})),[]);return"loading"===a.state?r()("div",{style:b.fullHeight},void 0,r()(be.Z,{style:b.spinner})):"empty"===a.state?r()("div",{style:b.fullHeight},void 0,r()(Ue,{heading:r()(p.FormattedMessage,{id:"page_analytics.empty.heading",defaultMessage:"No page analytics yet"}),description:r()(p.FormattedMessage,{id:"page_analytics.empty.description",defaultMessage:"It may take some time for page view information to appear."})})):"disabled-for-workspace"===a.state?r()("div",{style:b.fullHeight},void 0,r()(Ue,{heading:r()(p.FormattedMessage,{id:"page_analytics.disabled.heading",defaultMessage:"Page viewership tracking is disabled"}),description:r()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:16}},void 0,r()(p.FormattedMessage,f?{id:"page_analytics.disabled.description",defaultMessage:"Page viewership and analytics is turned off for all pages in {name}",values:{name:f}}:{id:"page_analytics.disabled.description.unnamed",defaultMessage:"Page viewership and analytics is turned off for all pages in your space"}),r()("a",{href:(0,pe.UY)("guides.pageAnalytics"),target:"_blank",style:{display:"flex",gap:4,color:y.regularTextColor,alignItems:"center",textDecoration:"none",cursor:"pointer"}},void 0,(0,X.m)({width:14,height:14}),r()(we.Z,{isSmall:!0},void 0,r()(p.FormattedMessage,{id:"page_analytics.disabled.learnMore",defaultMessage:"Learn more"}))))})):r()("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"}},void 0,r()(he.sg,{grow:1,gap:16},void 0,r()(Ze,{store:t,data:a.data,currentFilter:n,onChangeFilter:s}),r()(Pe,{store:t}),r()(Oe,{spaceId:i,store:t})),r()("div",{style:{borderTop:`1px solid ${y.regularDividerColor}`,padding:"12px 16px",display:"flex",justifyContent:"space-between",alignItems:"center"}},void 0,r()(fe.ZP,{renderOrigin:e=>{let{onClick:t}=e;return r()(Se.Z,{onClick:t,icon:Q.H},void 0,r()(p.FormattedMessage,{id:"page_analytics.timeseries.settings",defaultMessage:"Settings"}))},popupType:v.device.isMobile?fe.Z4.SlideUp:fe.Z4.Popup,render:()=>r()(g.Z,{menuType:k.og.Popup,width:460},void 0,r()("div",{style:xe},void 0,r()(Ie.PageAnalyticsPageOptOut,{store:t})))}),r()("a",{href:(0,pe.UY)("guides.pageAnalytics"),target:"_blank",style:{display:"flex",gap:4,color:y.regularTextColor,alignItems:"center",textDecoration:"none",cursor:"pointer"}},void 0,(0,X.m)({width:14,height:14}),r()(we.Z,{isSmall:!0},void 0,r()(p.FormattedMessage,{id:"page_analytics.timeseries.learnMore",defaultMessage:"Learn more"})))))}const xe={margin:"8px 16px",pointerEvents:"auto",cursor:"default"};function Ze(e){window.__c={n:"PageAnalyticsGraph"};const[t,i]=(0,ge.e)(),{blueLayer:o,yellowLayer:n}=(0,z.useTimeSeriesPalette)(),s=(0,d.useMemo)((()=>{if(0===e.data.length)return Ae;const t=$.OQ.isoToUnixMs(e.data[0].ds,"UTC")??Ae;return Math.min(t,Ae)}),[e.data]);return r()("div",{},void 0,r()(Fe,{store:e.store,data:e.data,currentFilter:e.currentFilter,onChangeFilter:e.onChangeFilter}),d.createElement("div",{ref:t,style:{...xe,marginBottom:0}},r()(me.LazyTimeSeries,{startDate:(0,W.$6)(s,!0),endDate:(0,W.$6)(Ae,!0),width:i,height:175,data:e.data,layers:[{key:"total_views",...o,renderLabel:e=>r()(p.FormattedMessage,{id:"page_analytics.timeseries.total_views",defaultMessage:"{views, plural, one {1 total view} other {{views} total views}}",values:{views:e}})},{key:"unique_views",...n,renderLabel:e=>r()(p.FormattedMessage,{id:"page_analytics.timeseries.unique_views",defaultMessage:"{uniqueViews, plural, one {1 unique view} other {{uniqueViews} unique views}}",values:{uniqueViews:e}})}]})))}function Fe(e){window.__c={n:"PageAnalyticsHeader"};const t=(0,p.useIntl)(),i=(0,d.useMemo)((()=>e.data.reduce(((e,t)=>{let{values:i}=t;return e+i.total_views}),0)),[e.data]);return r()("div",{style:{margin:"14px 16px",display:"flex",justifyContent:"space-between",alignItems:"center"}},void 0,r()(he.X2,{justifyContent:"space-between",alignItems:"center",grow:1},void 0,r()(he.X2,{gap:4},void 0,r()(we.Z,{style:{fontWeight:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.timeseries.title",defaultMessage:"Views"})),r()(we.Z,{isSecondaryColor:!0},void 0,r()(p.FormattedMessage,{id:"page_analytics.timeseries.totalViews",defaultMessage:"({totalViews} total)",values:{totalViews:(0,ee.uf)(i,"number_with_commas",t)}}))),r()(ke.f,{currentFilter:e.currentFilter,onChangeFilter:e.onChangeFilter})))}function Pe(e){window.__c={n:"PageAnalyticsViewers"};const{store:t}=e,{pageVisitStore:i,presenceStore:o}=(0,l.Kw)(N.default),n=(0,m.O7)();(0,d.useEffect)((()=>{re.Ri(n,{block:t,pageVisitStore:i,incremental:!1,limit:re.s4})}),[n,t,i]);const s=(0,l.VK)((()=>(0,le.AQ)(i,o)),[i,o]);if(0===s.length)return null;const a=s.map((e=>{let{userId:i,activityTimestampNearestMinuteMs:o}=e;return{actorStore:ye.U6.createChildStore(t,{id:i,table:oe.KJ}),timestamp:o}}));return r()("div",{style:{...xe,display:"flex",flexDirection:"column",gap:12}},void 0,r()(we.Z,{style:{fontWeight:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.viewers.title",defaultMessage:"Viewers"})),r()("div",{style:{display:"flex",flexDirection:"column",gap:10}},void 0,r()(_e,{store:t,actorStores:a,collapsedLabel:r()(p.FormattedMessage,{id:"page_analytics.viewers.expand",defaultMessage:"Show more viewers"}),expandedLabel:r()(p.FormattedMessage,{id:"page_analytics.viewers.collapse",defaultMessage:"Show less viewers"})})))}function _e(e){window.__c={n:"PageAnalyticsActorList"};const{store:t,actorStores:i,collapsedLabel:o,expandedLabel:n}=e,[s,a]=(0,d.useState)(!0),l=s?i.slice(0,5):i;return r()("div",{style:{display:"flex",flexDirection:"column",gap:10}},void 0,l.map((e=>{let{actorStore:i,timestamp:o}=e;return r()(De,{store:t,actorStore:i,timestamp:o},i.id)})),i.length>5&&r()("button",{onClick:e=>{e.preventDefault(),a(!s)},style:{background:"none",border:"none",textAlign:"left",padding:0,marginTop:4}},"toggle",r()(we.Z,{isSecondaryColor:!0,isSmall:!0,style:{display:"flex",gap:3,alignItems:"center"}},void 0,s?o:n,s?(0,Y.E)({width:12}):(0,q.R)({width:12}))))}function De(e){window.__c={n:"PageAnalyticsActor"};const{actorStore:t,timestamp:i}=e,o=(0,p.useIntl)(),n=(0,d.useMemo)((()=>{const e=Date.now();return(0,W.tv)(Math.min(i??e,e),G.SP)}),[i]),s=(0,l.VK)((()=>t.getDisplayName(o)),[t,o]);return r()(he.X2,{alignItems:"center",justifyContent:"space-between"},void 0,r()(he.X2,{gap:4},void 0,r()(Be,{actorStore:t}),r()(we.Z,{style:{fontWeight:500}},void 0,s)),r()(we.Z,{isSecondaryColor:!0},void 0,i?r()("span",{title:(0,W.Yx)(i,"medium_with_time",G.SP)},void 0,n):n))}function Be(e){const{actorStore:t}=e;return t.table===ie.cZ?r()(Me.Z,{botStore:t,size:18}):t.table===oe.KJ?r()(Ce.Z,{userStore:t,size:18}):t.table===te.y?r()(Ce.Z,{userStore:void 0,size:18}):void(0,x.t1)(t)}function Re(e){const{environment:t,store:i,spaceId:o,hasAccessToEditors:n}=e,[,,s]=(0,l.AF)(void 0,ve.o),[a,r]=(0,d.useState)([]);(0,d.useEffect)((()=>{n&&se.h(t,{store:s,activityIds:a,spaceId:o,filterActivityTypes:[],filterDateRange:{starting:void 0,ending:void 0},navigableBlockId:i.id})}),[a,s,o,i.id,t,n]);return(0,l.VK)((()=>{if(!n)return[];const e=s.state.activityIds;(0,ne.Z)(a,e)||r(e);const{currentSpaceStore:t}=N.default.state;if(!t)return[];const o=a.map((e=>(0,ce.No)(t,e,t.id))).flatMap((e=>{const t=e.getValue();return t?"top-level-block-created"!==t.type&&"top-level-block-deleted"!==t.type&&"block-edited"!==t.type?[]:function(e,t){var i;return J.oA(null===(i=e.edits)||void 0===i?void 0:i.flatMap((e=>{var i;return null===(i=e.authors)||void 0===i?void 0:i.map((i=>({actorStore:(0,de.nc)({parentStore:t,pointer:i}),timestamp:e.timestamp})))})))}(t,i):[]})),d=J.MR(o,"timestamp").reverse();return J.mN(d,"userId")}),[a,s,n,i])}function Oe(e){window.__c={n:"PageAnalyticsEditors"};const{spaceId:t,store:i}=e,o=(0,m.O7)(),n=(0,l.VK)((()=>(0,ue.qb)(o,"business")||(0,ue.qb)(o,"enterprise")),[o]),s=Re({environment:o,hasAccessToEditors:n,spaceId:t,store:i}),a=(0,l.VK)((()=>{const e=i.getCreatedByPointer(),t=i.getCreatedTime();if(e&&t)return{actorStore:(0,de.nc)({parentStore:i,pointer:e}),createdTime:t}}),[i]);return r()("div",{style:{...xe,display:"flex",flexDirection:"column",gap:12}},void 0,r()(we.Z,{style:{fontWeight:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.editors.title",defaultMessage:"Editors"})),a&&r()("div",{style:{display:"flex",flexDirection:"column",gap:10,marginBottom:6}},void 0,r()(we.Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.editors.createdBy",defaultMessage:"Created by"})),r()(De,{store:i,actorStore:a.actorStore,timestamp:a.createdTime})),n&&s.length>0&&r()("div",{style:{display:"flex",flexDirection:"column",gap:10}},void 0,r()(we.Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:500}},void 0,r()(p.FormattedMessage,{id:"page_analytics.editors.editedBy",defaultMessage:"Recently edited by"})),r()(_e,{actorStores:s,store:i,collapsedLabel:r()(p.FormattedMessage,{id:"page_analytics.editors.expand",defaultMessage:"Show more editors"}),expandedLabel:r()(p.FormattedMessage,{id:"page_analytics.editors.collapse",defaultMessage:"Show less editors"})})))}function Ue(e){window.__c={n:"PageAnalyticsEmptyState"};const t=(0,c.yK)((e=>({column:{display:"flex",flexDirection:"column"},row:{display:"flex"},centered:{textAlign:"center",alignItems:"center",width:250},analyticsIcon:{position:"relative",top:-8,left:-4},secondaryIcon:{fill:e.mediumTextColor},settingsButton:{padding:"7.5px 10px",alignSelf:"center"},link:{cursor:"pointer",justifyContent:"center",alignItems:"center",padding:8,alignSelf:"center"}})),[]);return r()("div",{style:{...t.column,gap:24}},void 0,r()("div",{style:{...t.column,...t.centered,gap:4}},void 0,(0,j.z)({...t.secondaryIcon,...t.analyticsIcon,width:62,height:62}),r()(we.Z,{isSecondaryColor:!0,style:{fontSize:16,fontWeight:500}},void 0,e.heading),r()(we.Z,{isSecondaryColor:!0,style:{whiteSpace:"normal",overflow:"visible"}},void 0,e.description)))}function Le(e){let{enablePageAnalytics:t}=e;window.__c={n:"UpdateSidebarTabUpdates"};const i=(0,l.VK)((()=>N.default.state.mainEditorCurrentBlockStore),[]),o=(0,l.VK)((()=>{const e=L.ou.now().minus({years:1}).valueOf();return!!i&&i.getCreatedTime()<e}),[i]),n=(0,l.VK)((()=>N.default.state.currentSpaceStore),[]),s=(0,l.VK)((()=>!(null!=i&&i.canRead())),[i]),a=(0,m.O7)(),g=(0,l.VK)((()=>(0,K._c)(a)),[a]),v=(0,l.VK)((()=>{var e;const t=null==i?void 0:i.getModel();return i&&null!=t&&t.isCollectionView()?null===(e=i.getCollectionPointer())||void 0===e?void 0:e.id:void 0}),[i]),y=(0,l.VK)((()=>Boolean(null==n?void 0:n.getSettings().disable_page_analytics)),[n]),f=(0,c.yK)((e=>({updatesEmptyStyle:{flex:1,display:"flex",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,background:e.contentBackground,marginRight:g?2:0,pointerEvents:"auto",height:"100%"},updatesNotEmptyStyle:{display:"flex",flexDirection:"column",flex:"1 1 0%",background:e.contentBackground,marginRight:g?2:0,pointerEvents:"auto",marginTop:1,height:"100%"}})),[g]),h=(0,l.VK)((()=>S.ZP.state.currentSubTab),[]);if(s)return r()(H.Z,{type:E.Z.Y,style:f.updatesEmptyStyle},void 0,r()("div",{style:{width:200,alignSelf:"center"}},void 0,r()(p.FormattedMessage,{id:"updateSidebar.commentContainer.restricted",defaultMessage:"You don't have permission to view the updates of this restricted page."})));if(n&&i)return d.createElement(H.Z,{type:E.Z.Y,ref:e=>{V.Z.UpdateSidebarScroller=e},style:f.updatesNotEmptyStyle},t&&r()("div",{style:{display:h===S.uF.Analytics?"block":"none",height:"100%"}},void 0,r()(Te,{spaceId:n.id,store:i,isDisabledForWorkspace:y})),r()("div",{style:{display:h===S.uF.Updates?"block":"none"}},void 0,r()(u.Z,{collectionId:v,navigableBlock:i,spaceId:n.id,source:"updates_sidebar",empty:e=>d.createElement(H.Z,{type:E.Z.Y,style:f.updatesEmptyStyle,ref:e=>{V.Z.UpdateSidebarScroller=e}},r()("div",{style:{width:200,alignSelf:"center"}},void 0,e.hasFiltersOn?r()(p.FormattedMessage,{id:"updateSidebar.updatesContainer.emptyAfterSearch",defaultMessage:"No updates match the requested filters."}):r()(p.FormattedMessage,o?{id:"updateSidebar.updatesContainer.emptyMaybePurged",defaultMessage:"There are no recent updates on this page. Page updates are retained for one year."}:{id:"updateSidebar.updatesContainer.empty",defaultMessage:"No updates on this page yet."})))},i.id)));throw new Error("Loaded sidebar without AppStore initialized.")}var Ve=i(38755),Ke=i(33784),Ee=i(38302),Ne=i(88923);function He(e){window.__c={n:"UpdateSidebarContent"};const{currentTab:t}=e,i=(0,l.VK)((()=>N.default.state.mainEditorCurrentBlockStore),[]),o=(0,l.VK)((()=>N.default.state.currentSpaceStore),[]),n=(0,l.VK)((()=>N.default.state.renderPhase),[]),[s,a]=(0,d.useState)(!1),c=(0,d.useMemo)((()=>(new Date).getTime()),[]);if((0,d.useEffect)((()=>{s||"rendered"!==n||a(!0)}),[null==i?void 0:i.id,s,n]),!i||!o||!s)return r()(O.B,{areaHeight:window.innerHeight});switch(t){case S.gY.Comments:return r()(U.J,{timeMounted:c,location:"sidebar"});case S.gY.Updates:return r()(Le,{enablePageAnalytics:e.enablePageAnalytics});case S.gY.Assistant:return r()(_.QP,{});default:(0,x.t1)(t)}}function ze(e){window.__c={n:"UpdateSidebar"};const t=(0,l.VK)((()=>({width:S.ZP.state.width,isAnimating:S.ZP.state.isAnimating})),[]),i=(0,m.O7)(),{shouldLoadSidebarComponents:o,isExpanded:n,popOutMode:s,closeSidebar:a}=e,p=(0,l.VK)((()=>n&&s&&!Ee.Z.state.isOpen&&!Ke.Z.state.open),[n,s]),u=(0,d.useRef)(null),g=(0,d.useMemo)((()=>[`.${f.zar}`,`.${f.hzx}`,`.${f.G6g}`,`.${f.K3y}`,`.${f.p0b}`,`.${f.mJW}`]),[]);(0,T.O)({active:p,closeHandler:a,ref:u,excludedSelectors:g});const y=v.R6(i.device.isElectronMac),h=(0,c.yK)((e=>({container:{flexGrow:0,flexShrink:0,zIndex:Z.XB,borderLeft:(s?"unset":!n&&"1px solid rgba(0,0,0,0)")||`1px solid ${e.regularDividerColor}`,alignSelf:"flex-end",position:"absolute",right:0,top:0,height:"100vh",pointerEvents:"none"},popOutContainer:{boxShadow:e.mediumBoxShadow,background:e.popoverBackground,borderRadius:3,border:n?`1px solid ${e.regularDividerColor}`:void 0,height:`calc(100% - 20px - ${y}px)`,marginTop:y+10,marginRight:n?10:0},wrap:{height:"100%"},content:{position:"absolute",top:0,bottom:0,display:n?"flex":"none",flexDirection:"column",overflow:"visible",zIndex:Z.XB,width:t.width}})),[t.width,y,s,n]);return o?d.createElement("aside",{"aria-hidden":!n||void 0,ref:u,style:{...h.container,...s?h.popOutContainer:{}},onMouseMove:()=>{t.isAnimating||S.ZP.setState({...S.ZP.state,mouseEntered:!0})},onMouseLeave:()=>{t.isAnimating||S.ZP.setState({...S.ZP.state,mouseEntered:!1})}},r()("div",{style:h.wrap},void 0,r()("div",{style:h.content},void 0,d.createElement(We,e)))):null}function Ge(e){let{enablePageAnalytics:t,navigableBlock:i,onTabChange:o}=e;window.__c={n:"SidebarHeader"};const n=(0,m.O7)(),{popOutMode:s}=(0,l.VK)((()=>({popOutMode:(0,K._c)(n)})),[n]),a=(0,l.VK)((()=>S.ZP.state.currentTab),[]),d=(0,c.yK)((()=>({commentsHeaderStyle:{position:"relative",pointerEvents:"auto",marginTop:s?0:v.R6(n.device.isElectronMac)}})),[n,s]);switch(a){case S.gY.Comments:return r()("div",{style:d.commentsHeaderStyle});case S.gY.Updates:return r()(C,{popOutMode:s,navigableBlock:i,enablePageAnalytics:t,onTabChange:o});case S.gY.Assistant:return r()("div",{style:d.commentsHeaderStyle})}}function We(e){window.__c={n:"SidebarActivityFeed"};const{isResizerHovered:t,isResizing:i,currentTab:o,expanded:n}=(0,l.VK)((()=>{const{isResizerHovered:e,isResizing:t,currentTab:i,expanded:o}=S.ZP.state;return{isResizerHovered:e,isResizing:t,currentTab:i,expanded:o}}),[]),{currentBlockStore:s}=e,a=(0,m.O7)(),{currentTabToRender:p,popOutMode:u}=(0,l.VK)((()=>({currentTabToRender:s.isCollectionView()&&!s.isCollectionViewPageWithContent()&&o!==S.gY.Assistant?S.gY.Updates:o,popOutMode:(0,K._c)(a)})),[s,o,a]),g=(0,l.VK)((()=>{const{currentSpaceStore:e}=N.default.state;return!(0,Ve.Cx)(e)}),[]),y=d.useCallback((e=>{F.Zmw(a,{tab:e===S.uF.Updates?"updates":"analytics",origin:Ne.default.state.open?"peek_view":"page"}),S.ZP.setState({...S.ZP.state,currentSubTab:e})}),[a]),h=(0,c.yK)((e=>({pane:{display:"flex",flexDirection:"column",height:"100%",position:"relative",pointerEvents:"none",maxHeight:"100%",backgroundColor:o===S.gY.Comments?void 0:"inherit"},resizerStyle:{position:"absolute",top:0,left:-3,bottom:0,right:0,height:"100vh",width:3,zIndex:-1,display:"block",transition:"box-shadow 300ms ease-in",...(t||i)&&n?{boxShadow:e.sidebarResizerBoxShadow}:{}},controlsHeaderStyle:{position:"relative",pointerEvents:"auto",marginTop:u?0:v.R6(a.device.isElectronMac),paddingTop:4,width:u?"calc(100% - 2px)":"100%",background:e.contentBackground,borderRadius:3,paddingBottom:1}})),[o,t,i,a,n,u]);return r()("div",{style:h.pane,className:f.zar},void 0,r()("div",{style:h.resizerStyle}),r()(Ge,{enablePageAnalytics:g,navigableBlock:s,onTabChange:y}),r()(He,{currentTab:p,enablePageAnalytics:g}),n&&r()(R.Z,{type:"update"}))}function $e(e){window.__c={n:"UpdateSidebarAnimatedWrapper"};const{isElectronMac:t,currentBlockStore:i}=e,o=(0,l.VK)((()=>({width:S.ZP.state.width,isAnimating:S.ZP.state.isAnimating,canRender:S.ZP.state.canRender})),[]),n=(0,l.VK)((()=>N.default.state.currentSpaceStore),[]),s=(0,d.useMemo)((()=>null==n?void 0:n.clone()),[n]),a=(0,m.O7)(),c=(0,l.VK)((()=>a.currentUser.isLoggedIn()&&(0,K.Sx)(a)),[a]),{isExpanded:p,popOutMode:u,closeSidebar:g}=(0,l.VK)((()=>({isExpanded:(0,K.Sx)(a),popOutMode:(0,K._c)(a),closeSidebar:()=>P.setUpdateExpand({environment:a,isExpanded:!1,from:"close_for_space"})})),[a]),[v,y]=(0,d.useState)(!1),[f,h]=(0,d.useState)(void 0);return(0,d.useEffect)((()=>{(void 0===f||f===i.id)&&p&&(y(!0),h(i.id))}),[f,i,p]),o.canRender&&s?r()(D.Z,{isVisible:!0,useCompositeLayer:!0,animationStyle:{width:c?o.width:0},render:()=>r()(B.Z,{store:s,droppable:!0,render:()=>r()(ze,{isElectronMac:t,isFullyExpanded:!o.isAnimating,currentBlockStore:i,isExpanded:p,popOutMode:u,closeSidebar:g,shouldLoadSidebarComponents:v})},s.id),onAnimationStart:()=>{S.ZP.setState({...S.ZP.state,isAnimating:!0})},onAnimationEnd:()=>{S.ZP.setState({...S.ZP.state,isAnimating:!1})}}):null}},44904:(e,t,i)=>{i.d(t,{o:()=>n});var o=i(49085);class n extends o.default{getInitialState(){return{activityIds:[],shouldLoadNewerActivities:!1,shouldLoadOlderActivities:!0,hasOlderActivities:!0,filterActivityTypes:[],filterDateRange:{starting:void 0,ending:void 0}}}}},47054:(e,t,i)=>{i.d(t,{AD:()=>d});i(57658);var o=i(30120),n=i(59730),s=i(63143);function a(e){if(void 0===e)return o.ou.utc();const t={zone:"utc"};return"number"==typeof e?o.ou.fromMillis(e,t):o.ou.fromISO(e,t)}function r(e,t){const i=t?a(t):o.ou.utc(),s=a(e??function(e){const{days:t,endDate:i,startDate:s}=e;if(t<=0)throw new n.p8("Days must be greater than 0");const r=i?a(i):o.ou.utc();if(!r.isValid)throw new n.p8(`endDate ${i} is in an invalid format`);const d=s?a(s).toMillis():0,l=r.minus({days:t-1}).toMillis();return Math.max(l,d)}({days:7,endDate:t}));if(!s.isValid)throw new n.p8(`startDate ${e} is in an invalid format`);if(!i.isValid)throw new n.p8(`endDate ${t} is in an invalid format`);if(s>i)throw new n.p8(`startDate ${e} => ${s.toISO()} is after endDate ${t} => ${i.toISO()}`);return{startTimestamp:s.toMillis(),endTimestamp:i.toMillis()}}function d(e,t){const{startTimestamp:i,endTimestamp:o}=r(e,t),n=[];for(var d=i;d<=o;)n.push(a(d).toISODate()),d+=s.A0;return n}},83176:(e,t,i)=>{i.d(t,{z:()=>s});var o=i(23174),n=i.n(o);i(67294);const s=(0,i(45238).I)("analyticsSearch",{viewBox:"0 0 51 52",svg:n()("path",{d:"M.414 21.297c0 2.86.533 5.543 1.6 8.049a21.156 21.156 0 004.468 6.576 20.797 20.797 0 006.577 4.443c2.505 1.067 5.18 1.6 8.023 1.6 2.116 0 4.13-.305 6.043-.914a21.55 21.55 0 005.332-2.565l11.654 11.655a3.44 3.44 0 001.245.812c.473.186.964.28 1.472.28.728 0 1.371-.17 1.93-.508a3.48 3.48 0 001.32-1.346 3.887 3.887 0 00.482-1.93 3.8 3.8 0 00-.279-1.447 3.126 3.126 0 00-.787-1.193l-11.578-11.63a20.414 20.414 0 002.818-5.51c.694-2.013 1.041-4.138 1.041-6.372 0-2.844-.541-5.51-1.625-7.998a20.718 20.718 0 00-4.443-6.602 20.515 20.515 0 00-6.602-4.468c-2.488-1.067-5.162-1.6-8.023-1.6-2.844 0-5.518.533-8.023 1.6a20.592 20.592 0 00-6.577 4.468A21.072 21.072 0 002.014 13.3c-1.067 2.488-1.6 5.154-1.6 7.998zm5.408 0c0-2.1.39-4.071 1.168-5.916a15.517 15.517 0 013.301-4.875 15.168 15.168 0 014.875-3.276c1.845-.795 3.817-1.193 5.916-1.193 2.116 0 4.096.398 5.941 1.193a14.877 14.877 0 014.85 3.276 15.515 15.515 0 013.3 4.875c.796 1.845 1.194 3.817 1.194 5.916 0 2.116-.398 4.096-1.193 5.941a15.517 15.517 0 01-3.301 4.875 15.426 15.426 0 01-4.85 3.276c-1.845.795-3.825 1.193-5.941 1.193-2.099 0-4.07-.398-5.916-1.193a15.737 15.737 0 01-4.875-3.276 15.52 15.52 0 01-3.3-4.875c-.78-1.845-1.169-3.825-1.169-5.941zm15.31 10.36c.458 0 .746-.263.864-.788.237-1.32.474-2.437.711-3.351.254-.931.559-1.693.914-2.286a4.554 4.554 0 011.397-1.498c.575-.389 1.311-.694 2.209-.914.914-.237 2.056-.448 3.427-.634.542-.085.813-.381.813-.89 0-.507-.271-.812-.813-.913-1.354-.17-2.496-.373-3.427-.61-.915-.253-1.668-.567-2.26-.939a4.814 4.814 0 01-1.422-1.498c-.373-.61-.677-1.363-.914-2.26a42.337 42.337 0 01-.635-3.326c-.084-.542-.372-.813-.863-.813s-.796.263-.914.788a53.724 53.724 0 01-.737 3.377c-.22.914-.507 1.675-.863 2.285a4.64 4.64 0 01-1.396 1.472c-.576.373-1.32.677-2.235.914-.914.22-2.048.424-3.402.61-.559.101-.838.406-.838.914 0 .49.28.787.838.889 1.693.186 3.055.44 4.088.761 1.032.305 1.828.762 2.387 1.371.575.61 1.015 1.44 1.32 2.489.305 1.05.584 2.395.838 4.037a1 1 0 00.279.584c.17.152.38.228.635.228z"})})},90792:(e,t,i)=>{i.d(t,{t:()=>s});var o=i(23174),n=i.n(o);i(67294);const s=(0,i(45238).I)("bell",{viewBox:"0 0 16 16",svg:n()("path",{d:"M1.36914 11.7627C1.36914 12.3369 1.80664 12.7266 2.51074 12.7266H5.32031C5.38184 14.0322 6.44824 15.2285 8 15.2285C9.55176 15.2285 10.6182 14.0391 10.6797 12.7266H13.4893C14.2002 12.7266 14.6309 12.3369 14.6309 11.7627C14.6309 11.0381 13.9678 10.416 13.3457 9.81445C12.8672 9.34277 12.751 8.39941 12.6621 7.46289C12.5732 4.87207 11.8213 3.14258 10.0371 2.49316C9.77734 1.59082 9.01855 0.900391 8 0.900391C6.98145 0.900391 6.22266 1.59082 5.96289 2.49316C4.17871 3.14258 3.42676 4.87207 3.33789 7.46289C3.24902 8.39941 3.13965 9.34277 2.6543 9.81445C2.03906 10.416 1.36914 11.0381 1.36914 11.7627ZM3.00293 11.4756V11.3936C3.18066 11.1953 3.57715 10.833 3.91211 10.4434C4.38379 9.90332 4.60254 8.92578 4.6709 7.62695C4.75293 4.85156 5.60059 3.92871 6.70801 3.62793C6.87207 3.58691 6.96777 3.50488 6.98145 3.32031C7.01562 2.62305 7.39844 2.1582 8 2.1582C8.60156 2.1582 8.99121 2.62305 9.01855 3.32031C9.03223 3.50488 9.12793 3.58691 9.29883 3.62793C10.3994 3.92871 11.2539 4.85156 11.3291 7.62695C11.3975 8.92578 11.623 9.90332 12.0879 10.4434C12.4297 10.833 12.8125 11.1953 12.9834 11.3936V11.4756H3.00293ZM6.6123 12.7266H9.3877C9.33984 13.5811 8.7793 14.1348 8 14.1348C7.22754 14.1348 6.66699 13.5811 6.6123 12.7266Z"})})},79198:(e,t,i)=>{i.d(t,{n:()=>s});var o=i(23174),n=i.n(o);i(67294);const s=(0,i(45238).I)("refresh",{viewBox:"0 0 24 20",svg:n()("path",{d:"M0.19663 9.99023C-0.184229 10.5273-0.00844799 11.0059 0.694677 11.0059L2.04233 11.0059C2.56968 15.9766 6.85679 19.9219 11.9447 19.9219C14.9232 19.9219 17.6185 18.5645 19.4544 16.4551C19.8158 16.0352 19.7669 15.5078 19.3861 15.2344C19.0052 14.9609 18.5365 15.0586 18.224 15.4199C16.7103 17.168 14.4642 18.2617 11.9447 18.2617C7.68686 18.2617 4.22007 15.1074 3.72202 11.0059L5.1771 11.0059C5.87046 11.0059 6.04624 10.5273 5.67515 10L3.48765 6.88477C3.17515 6.43555 2.7064 6.42578 2.38413 6.88477ZM4.44468 3.4668C4.07358 3.88672 4.12241 4.4043 4.51304 4.67773C4.8939 4.95117 5.35288 4.86328 5.67515 4.50195C7.19858 2.76367 9.44468 1.66016 11.9447 1.66016C16.1927 1.66016 19.6595 4.81445 20.1673 8.92578L18.7123 8.92578C18.0189 8.92578 17.8431 9.39453 18.2142 9.93164L20.4017 13.0469C20.7142 13.4961 21.183 13.5059 21.5052 13.0469L23.683 9.94141C24.0736 9.39453 23.888 8.92578 23.1849 8.92578L21.847 8.92578C21.3099 3.95508 17.0326 0 11.9447 0C8.96616 0 6.28061 1.34766 4.44468 3.4668Z"})})}}]);
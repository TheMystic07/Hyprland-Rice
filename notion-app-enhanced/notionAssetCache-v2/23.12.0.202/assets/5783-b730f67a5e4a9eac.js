"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5783],{70442:(e,t,a)=>{a.d(t,{$7:()=>V,GF:()=>R,Hp:()=>F,Lf:()=>L,RL:()=>A,rC:()=>B,xv:()=>H,zO:()=>Z});a(21703);var i=a(15145),o=a(92785),n=a(59730),r=a(15157),s=a(5366),l=a(45953),c=a(21202),m=a(23867),p=(a(95477),a(33929)),d=a(98165),u=a(80444),g=a(56638),f=a(50906),y=a(54642),v=a(54532),w=a(89858),b=a(9953),S=a(4408),T=a(75018),h=a(24677),k=a(74647),C=a(28014),I=a(39699),M=a(39865);const P="LastViewedTemplateId",_=(0,s.defineMessages)({clientCopyError:{defaultMessage:"Client copy could not be created.",id:"spaceActions.createGettingStartedPage.copyNotCreated.error"}});function V(e){const{environment:t,item:a,createNewPage:i,isPrivate:o}=e;h.ZH(t),g.Z.setState({open:!0,item:a,createNewPage:i,isPrivate:o,isLoading:!1}),r.Z.set({userId:t.currentUser.id,key:P,value:a.rootId}),f.jWY(t,{template_name:a.name,from:i?"sidebar":"newPage"})}function Z(e){let{templateItem:t,currentUserId:a}=e;const i=g.Z.state.item;g.Z.setState({...g.Z.state,item:t}),i!==t&&r.Z.set({userId:a,key:P,value:t.rootId})}function H(e){g.Z.setState({item:g.Z.state.item,open:!1}),h.ZH(e)}async function A(e){const{item:t,environment:a,spaceStore:o}=e;g.Z.state.open&&g.Z.setState({...g.Z.state,isLoading:!0});const n=e.initializeStore?{...e,initializeStore:e.initializeStore,isPrivate:!1,type:"inExistingStore",useMinimalTemplates:!1}:{...e,type:"inSpace",useMinimalTemplates:!1,isOnboarding:!1};let r=!1;const s=Date.now();let l;try{l=await B(n),r=!0,T.navigateToBlock({environment:a,store:l,pageVisitSource:i.tY.Create}),H(a),a.device.isMobile&&k.close()}finally{var c;const i=Date.now()-s,n=e.initializeStore?d.VP(e.initializeStore):void 0,m=e.initializeStore?!Boolean(n):e.isPrivate;f.enX(a,{template_name:t.name,destination:m?"private":"team",template_block_id:t.rootId,template_duplication_duration_ms:i,team_id:null==n?void 0:n.id,created_page_id:null===(c=l)||void 0===c?void 0:c.id}),f.XyT(a,{from:"inApp",success:r,context:e.from,template_name:t.name,template_block_id:t.rootId,target_space_id:o.id,template_duplication_duration_ms:i})}}async function L(e){const{environment:t,initializeStore:a,item:i,isPrivate:o,useMinimalTemplates:n,spaceStore:r,spaceViewStore:s}=e,c=n?i.rootId:i.previewRootId,m=await y.loadBlockSubtree(t,{block:{id:c,spaceId:i.spaceId},shallow:!1});let d;"success"===m.type&&(d=l.PF.create(m.data.subtreeRecordMap));const u="pageTemplateModalActions.loadAndDuplicatePageTemplate",{performResult:g}=I.createAndCommit({userAction:u,environment:t,perform:e=>{const i=a||C.KE({environment:t,spaceStore:r,spaceViewStore:s,isPrivate:o,loading:!0,transaction:e});S.fL({environment:t,inMemoryRecordCache:i.inMemoryRecordCache,recordMap:d,debugSource:u});const n=v.K8(t,{blockId:c,inMemoryRecordCache:i.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!n)throw new Error(p.default.getIntl().formatMessage(_.clientCopyError));return v.E9({environment:t,sourceBlockId:c,targetBlockPointer:i.pointer,sourceBlockSubtree:n,targetInMemoryRecordCache:i.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:i.useCrdt()}),i}});return g}async function B(e){const{environment:t,item:a,useRecordCache:i,isPrivate:o,useMinimalTemplates:n,spaceStore:r,spaceViewStore:s,isOnboarding:l}=e,{serverCommitResult:m,performResult:{pageStore:p,copyBlock:d}}=I.createAndCommit({userAction:"pageTemplateModalActions.createTemplateInstance",environment:t,perform:l=>{let m;m="inExistingStore"===e.type&&e.initializeStore?e.initializeStore:"inTeam"===e.type&&e.teamStore?w.pq({environment:t,spaceStore:r,spaceViewStore:s,teamStore:e.teamStore,from:e.from,loading:!0,appendOrPrepend:e.appendOrPrepend?e.appendOrPrepend:"append",transaction:l}):C.KE({environment:t,spaceStore:r,spaceViewStore:s,isPrivate:o,loading:!0,transaction:l});const p={id:i&&!n?a.previewRootId:a.rootId,table:c.iU,spaceId:a.spaceId};return R({item:a,spaceViewStore:s,transaction:l}),function(e){const{item:t,transaction:a,spaceViewStore:i}=e;if(i){const e=i.getSidebarHiddenTemplateIds();if(e.indexOf(t.rootId)<0){const o=e.concat([t.rootId]);b.sW({store:i,data:{sidebar_hidden_templates:o},transaction:a})}}}({item:a,spaceViewStore:s,transaction:l}),{pageStore:m,copyBlock:p}}});return await m,await F({environment:t,pageStore:p,copyBlock:d,useRecordCache:i,item:a,isOnboarding:Boolean(l)}),p}const E={block:!0,collection:!0,collection_view:!0,discussion:!0,comment:!0};async function F(e){const{environment:t,pageStore:a,copyBlock:i,item:r,useRecordCache:s,isOnboarding:c}=e,p=l.Ak.create();s&&s.forEachRecord(t.currentUser.id,(e=>{let{model:t}=e;E[t.table]&&p.setModel(t.pointer,t)}));const{currentSpaceStore:d}=u.default.state;if(!d)throw new n.p8("Could not get currentSpaceStore.");return"failed"===(await y.initializePageTemplate(t,{recordMap:p.toJson({allowVersionDowngrade:!1}),sourceBlock:i,targetBlock:{id:a.pointer.id,table:a.pointer.table,spaceId:(0,m.C)(a.pointer.spaceId)},isOnboarding:c})).type&&(I.createAndCommit({userAction:"pageTemplateModalActions.initializePageTemplate.deletePageWhenError",environment:t,perform:e=>{M.y8({environment:t,blocks:[a],transaction:e})}}),c&&f.XyT(t,{success:!1,template_name:r.name,template_id:r.id,template_block_id:r.rootId,target_space_id:d.id,from:"onboarding"}),o.log({level:"error",from:"pageTemplateModalActions.initializePageTemplate",type:"duplicateTemplateError",data:{miscDataToConvertToString:{template_name:r.name,template_id:r.id,template_block_id:r.rootId,is_onboarding:c}}})),a}function R(e){const{item:t,transaction:a,spaceViewStore:i}=e;if(i){const e=i.getVisitedTemplateIds();if(e.indexOf(t.rootId)<0){const o=e.concat([t.rootId]);b.sW({store:i,data:{visited_templates:o},transaction:a})}}}},13401:(e,t,a)=>{a.d(t,{Z:()=>u});var i=a(10434),o=a.n(i),n=a(23174),r=a.n(n),s=a(67294),l=a(24405),c=a(8848),m=a(47453),p=a(31339),d=a(52275);const u=s.forwardRef(((e,t)=>{window.__c={n:"AddMenuItem"};const a=(0,l.yK)((t=>({base:{color:e.isBlue?c.ZP.blue:t.mediumTextColor}})),[e.isBlue]),{color:i}=a.base;return s.createElement(d.Z,o()({ref:t},e,{title:r()("div",{style:{color:i,fill:i}},void 0,e.title),icon:r()(p.Z,{icon:m.R,styles:{fill:i}})}))}))},31339:(e,t,a)=>{a.d(t,{Z:()=>s});var i=a(23174),o=a.n(i),n=(a(67294),a(83355));class r extends n.Z{renderComponent(){const e=this.environment.device.isMobile?r.mobileStyle:r.desktopStyle;return o()("div",{style:e},void 0,this.props.icon(this.props.styles))}}r.displayName="CollectionMenuIcon",r.desktopStyle={width:16},r.mobileStyle={width:16};const s=r},40698:(e,t,a)=>{a.d(t,{Im:()=>x,XI:()=>R,b6:()=>W,ss:()=>z});a(57658);var i=a(15145),o=a(35013),n=a(21321),r=a(69628),s=a(17948),l=a(42696),c=a(10405),m=a(82356),p=a(54851),d=a(54855),u=a(46783),g=a(73426),f=a(5366),y=a(4615),v=a(50906),w=a(75018),b=a(59389),S=a(39699),T=a(68821),h=a(12921),k=a(33929),C=a(98165),I=a(67669),M=a(89014),P=a(47593),_=a(67940),V=a(83212),Z=a(92083),H=a(37394);const A=(0,f.defineMessages)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),L=[{name:k.default.formatMessage(A.emptyWithIcon),iconFn:p.S,type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{S.createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,perform:a=>{b.T_({environment:e,store:t,transaction:a})}})}},{name:k.default.formatMessage(A.empty),iconFn:d.a,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{S.createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,perform:a=>{b.eV({environment:e,store:t,transaction:a})}})}}],B={name:k.default.formatMessage(A.templates),type:"templates",iconFn:e=>(0,g.i)(e),shouldShow:()=>!0,onClick:()=>{H.Z.open({cloneTo:"current_page",analyticsFrom:"newPage"})}},E={name:k.default.formatMessage(A.templates),type:"templates",iconFn:e=>(0,u.w)(e),shouldShow:()=>!0,onClick:()=>{H.Z.open({cloneTo:"current_page",analyticsFrom:"newPage"})}},F={name:k.default.formatMessage(A.import),type:"import",iconFn:m.l,shouldShow:()=>!0,onClick:(e,t)=>{const a=(0,y.ZP)();_.Z.setState({flowId:a}),v.Syn(e,{from:"new_page",flowId:a}),(0,T.c)()?Z.Z.setState({...Z.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}):P.Z.setState({open:!0,pageStore:t})}},R=(e,t)=>{const a=(0,C.n3)(t)&&V.Z.getMode(e,t);return(0,I.YF)(a)?[...L]:[...L,a&&(0,h.GD)(e,a)?E:B,F]},N=(0,f.defineMessages)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),z=[{name:k.default.formatMessage(N.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{S.createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,perform:a=>{b.T_({environment:e,store:t,transaction:a})}})}},{name:k.default.formatMessage(N.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{S.createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,perform:a=>{b.eV({environment:e,store:t,transaction:a})}})}}],D=(0,f.defineMessages)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"},tableView:{defaultMessage:"Table view",id:"templatePickerHelpers.databaseTemplateNames.tableView"},boardView:{defaultMessage:"Board view",id:"templatePickerHelpers.databaseTemplateNames.boardView"},listView:{defaultMessage:"List view",id:"templatePickerHelpers.databaseTemplateNames.listView"},calendarView:{defaultMessage:"Calendar view",id:"templatePickerHelpers.databaseTemplateNames.calendarView"},galleryView:{defaultMessage:"Gallery view",id:"templatePickerHelpers.databaseTemplateNames.galleryView"},timelineView:{defaultMessage:"Timeline view",id:"templatePickerHelpers.databaseTemplateNames.timelineView"}});function O(e){const{environment:t,store:a,viewType:o}=e;S.createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,perform:e=>{b.Ud({environment:t,store:a,viewType:o,transaction:e}),w.navigateToBlock({environment:t,store:a,pageVisitSource:i.tY.LinkInPage});const n=a.getCollectionViewStores()[0];n&&(0,M.u)(n.id,{viewType:o})}})}const x=[{name:k.default.formatMessage(D.table),type:"table",iconFn:l.t,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>O({environment:e,store:t,viewType:"table"})},{name:k.default.formatMessage(D.board),type:"board",iconFn:o.i,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>O({environment:e,store:t,viewType:"board"})},{name:k.default.formatMessage(D.list),type:"list",iconFn:s.O,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>O({environment:e,store:t,viewType:"list"})},{name:k.default.formatMessage(D.timeline),type:"timeline",iconFn:c._,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>O({environment:e,store:t,viewType:"timeline"})},{name:k.default.formatMessage(D.calendar),type:"calendar",iconFn:n.N,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>O({environment:e,store:t,viewType:"calendar"})},{name:k.default.formatMessage(D.gallery),type:"gallery",iconFn:r.n,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>O({environment:e,store:t,viewType:"gallery"})}];function W(e,t){const a=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(a.has(t)&&e.push(a.get(t)),e)),[])}},73426:(e,t,a)=>{a.d(t,{i:()=>n});var i=a(23174),o=a.n(i);a(67294);const n=(0,a(45238).I)("templatesColor",{viewBox:"0 0 20 20",svg:o()("g",{},void 0,o()("path",{d:"M6.39733 5.67853C5.89764 5.50234 5.36002 5.40649 4.8 5.40649C2.14904 5.40649 0 7.55432 0 10.2038C0 12.8533 2.14904 15.0011 4.8 15.0011C6.52165 15.0011 8.0316 14.0952 8.87867 12.7343L5.26487 12.0975L6.39733 5.67853Z",fill:"#3C9ED7"}),o()("path",{d:"M17.3126 3.66609L7.85843 2L6.19141 11.4489L10.6545 12.2354L14.3998 5.81854L16.3449 9.15116L17.3126 3.66609Z",fill:"#E7595E"}),o()("path",{d:"M8.80078 17L14.4008 7.4054L20.0008 17H8.80078Z",fill:"#F5BC4E"}))})}}]);
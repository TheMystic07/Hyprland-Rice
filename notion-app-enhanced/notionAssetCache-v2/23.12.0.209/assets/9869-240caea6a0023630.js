"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9869],{10912:(e,t,r)=>{r.d(t,{Z:()=>T});var o=r(23174),i=r.n(o),s=(r(57658),r(67294)),n=r(83355),a=r(27531),l=r(41432),d=r(80951),h=r(95538),p=r(21202),c=r(97880),u=r(78316),g=r(17311),m=r(35328),v=r(57559),y=r(865),C=r(12981),f=r(81865),S=r(35541);function b(e){return"number"==typeof e}class I extends n.Z{constructor(){super(...arguments),this.renderContentBlock=e=>{const{store:t,renderAdditionalBlocks:r}=this.props,o=v.G.createChildStore(t,{table:p.iU,id:e}),s=o.getType(),n=r&&void 0!==s?(0,S.u)(o):(0,y.h)(o);if(n)return i()(a.D,{value:this.restrictedContentStore},void 0,i()(n,{store:o,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,hideContent:(0,m.BX)(o),style:{fontSize:12,opacity:.8,pointerEvents:"none"},isQuickFind:!0,numberedListCounterStore:this.createComputedStore((()=>({depth:0,numberedListBlockIdsWithFormat:this.createNumberedListCounterStore(e)})))},e))},this.coverStore=this.createComputedStore((()=>{const{store:e,renderAdditionalBlocks:t=!1}=this.props,r=(0,u.NU)(e,t);return r.image?r.image:r.blockIds})),this.restrictedContentStore=this.createComputedStore((()=>{const{store:e,renderAdditionalBlocks:t=!1}=this.props,r=(0,u.wK)(e,t);return r.image?void 0:r.blockIds})),this.numberedLists=this.createComputedStore((()=>{const{store:e}=this.props,t=this.coverStore.state,r=[];if(Array.isArray(t)){let o=0;for(;o<t.length;){let i=t[o],s=v.G.createChildStore(e,{table:p.iU,id:i});if(s.getType()===l.Ti.numberedList){const n=[{blockId:i,idx:1}],a=[{id:i,format:void 0,depth:n.length-1,index:n[0].idx}];for(o+=1;o<t.length&&(i=t[o],s=v.G.createChildStore(e,{table:p.iU,id:i}),s.getType()===l.Ti.numberedList);){{const e=s.getParentId();if(s.getParentId()===n[n.length-1].blockId)n.push({blockId:i,idx:1});else{let t=n[n.length-1].idx;for(;n.length>0&&n[n.length-1].blockId!==e;)t=n[n.length-1].idx,n.pop();n.push({blockId:i,idx:t+1})}a.push({id:i,format:void 0,depth:n.length-1,index:n[n.length-1].idx})}o+=1}r.push(a)}else o+=1}}return r}))}didUpdate(e){this.props.coverFormat.type!==e.coverFormat.type&&this.props.onLoadProxiedImage()}renderComponent(){const{coverFormat:e}=this.props;return"page_cover"===e.type?this.renderPageCover():"page_content"===e.type?this.renderPageContent():"property"===e.type?this.renderProperty(e.property):void 0}renderPageCover(){var e;const{store:t}=this.props,r=null===(e=t.getCover())||void 0===e?void 0:e.cover;return r?i()("div",{style:this.getImageCoverWrapStyle()},void 0,i()(f.Z,{url:r,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:this.getCoverWidth(),onFinishedLoadingProxyUrl:e=>this.props.onLoadProxiedImage(e),render:(e,t)=>{if(t)return i()(C.Z,{style:{...this.getImageStyle(),...this.getCoverStyle(),...this.getCoverAspectStyle(),objectPosition:`center ${100*(1-this.imagePosition)}%`},src:t})}}),this.renderImageBorder()):this.props.showEmptyGalleryCover?this.renderEmptyGalleryCover():void 0}renderPageContent(){const e=this.coverStore.state,t=this.restrictedContentStore.state;if(e){if(!Array.isArray(e))return i()("div",{style:this.getImageCoverWrapStyle()},void 0,i()(f.Z,{url:e.url,onFinishedLoadingProxyUrl:e=>this.props.onLoadProxiedImage(e),isAuthenticated:!0,permissionRecord:e.pointer,width:this.getCoverWidth(),render:(e,t)=>{if(t)return i()(C.Z,{style:{...this.getImageStyle(),...this.getPageContentImageStyle(),...this.getCoverAspectStyle(),objectPosition:`center ${100*(1-this.imagePosition)}%`},src:t})}}),this.renderImageBorder());if(e.length>0)return s.createElement(s.Fragment,null,i()("div",{style:this.getContentWrapStyle()},void 0,t?e.filter((e=>t.indexOf(e)>=0)).map(this.renderContentBlock):e.map(this.renderContentBlock),this.props.coverContentFadedOverlay&&i()("div",{style:this.getContentFadedOverlayStyle()})));if(this.props.showEmptyGalleryCover)return this.renderEmptyGalleryCover()}else if(this.props.showEmptyGalleryCover)return this.renderEmptyGalleryCover()}renderProperty(e){const{store:t}=this.props,r=(0,d.g)(t.getPropertyValue(e)).find((e=>(0,h.SR)({url:e.url})));return r?i()("div",{style:this.getImageCoverWrapStyle()},void 0,i()(f.Z,{onFinishedLoadingProxyUrl:e=>this.props.onLoadProxiedImage(e),url:r.url,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:this.getCoverWidth(),render:(e,t)=>{if(t)return i()(C.Z,{style:{...this.getImageStyle(),...this.getCoverStyle(),...this.getCoverAspectStyle(),objectPosition:`center ${100*(1-this.imagePosition)}%`},src:t})}}),this.renderImageBorder()):this.props.showEmptyGalleryCover?this.renderEmptyGalleryCover():void 0}renderEmptyGalleryCover(){return i()("div",{style:{height:this.getCoverHeight(),...this.props.emptyGalleryCoverStyle}})}renderImageBorder(){switch(this.props.variant){case"default":return null;case"gallery":return i()("div",{style:{position:"absolute",left:0,right:0,bottom:0,borderBottom:`1px solid ${this.theme.regularDividerColor}`}});default:(0,c.t1)(this.props.variant)}}get imagePosition(){const{coverPosition:e,store:t}=this.props;if(b(e))return e;if(t.getFormatStore().isDefined()){const{page_cover_position:e,card_cover_position:r}=t.getFormat();if(b(r))return r;if(b(e))return e}return.5}createNumberedListCounterStore(e){const t=this.numberedLists.state;for(const r of t)if(r.find((t=>t.id===e)))return r;return[]}getImageStyle(){return this.props.style||{}}getCoverHeight(){const{coverHeight:e,coverSizeFormat:t}=this.props;if(e)return e;switch(t){case"large":return g.Z.card.desktop.large.height;case"small":return g.Z.card.desktop.small.height;case"medium":default:return g.Z.card.desktop.medium.height}}getCoverWidth(){const{coverWidth:e,coverSizeFormat:t}=this.props;return e||(0,u.rD)(t)}getImageCoverWrapStyle(){return{height:this.getCoverHeight(),position:"relative",pointerEvents:"none",overflow:"hidden"}}getContentWrapVariantStyle(){const{ThemeStore:e}=this.environment,t="dark"===e.state.mode;switch(this.props.variant){case"default":return{};case"gallery":return{background:this.theme.collectionGalleryPreviewCardCover,padding:"8px 8px 0",boxShadow:t?"transparent":`inset 0 -1px 0 0 ${this.theme.regularDividerColor}`,...this.props.contentWrapStyle};default:(0,c.t1)(this.props.variant)}}getContentWrapStyle(){return{height:this.getCoverHeight(),pointerEvents:"none",overflow:"hidden",position:this.props.coverContentFadedOverlay?"relative":"static",...this.getContentWrapVariantStyle(),...this.props.contentWrapStyle}}getContentFadedOverlayStyle(){return{width:"100%",height:40,position:"absolute",bottom:0,left:0,background:`linear-gradient(to bottom, transparent, ${this.theme.accentColors.gray[30]} 100%)`,...this.props.coverContentFadedOverlayStyle}}getCoverVariantStyle(){switch(this.props.variant){case"default":return{border:`1px solid ${this.theme.stroke.regular}`,borderRadius:4};case"gallery":return{borderRadius:0,borderTopLeftRadius:1,borderTopRightRadius:1};default:(0,c.t1)(this.props.variant)}}getCoverStyle(){return{width:"100%",height:this.getCoverHeight(),...this.getCoverVariantStyle(),objectPosition:"center"}}getCoverAspectStyle(){const{coverAspectFormat:e}=this.props;return{objectFit:void 0===e?"cover":e}}getPageContentImageStyle(){return{...this.getCoverStyle(),objectPosition:"center center"}}}I.displayName="CollectionItemCover";const T=I},1924:(e,t,r)=>{r.d(t,{Z:()=>b});var o=r(23174),i=r.n(o),s=(r(67294),r(83355)),n=r(35840),a=r(5366),l=r(70203),d=r(82990),h=r(38755),p=r(5162),c=r(80444),u=r(25904),g=r(30857),m=r(29026),v=r(74194),y=r(68785),C=r(31278),f=r(33411);class S extends s.Z{constructor(){super(...arguments),this.typingTimer=void 0,this.renderLeft=()=>{const{showSpinner:e,selectedResult:t}=this.props,{device:r}=this.environment,o=this.styles,s={...this.getThemeColors().searchIcon,...o.searchIcon},a=null==t?void 0:t.getIcon(),l=Boolean(m.ZP.state.query.text.trim())&&!r.isMobile;return i()(f.Z,{show:e,showDelay:500,showHold:200,render:e=>(e=>i()("div",{style:o.headerIcon},void 0,e?i()(y.Z,{style:s}):l?i()(C.Z,{disabled:!0,icon:a,isEmptyPage:Boolean(a),size:20}):(0,n.R)(s)))(e)})},this.handleQueryChange=e=>{this.handleTyping();const t=String(e.target.value);this.props.onQueryChange(t)},this.handleClearButtonClick=()=>{m.ZP.resetQuery({resetFilters:!0}),m.ZP.update((e=>({...e,source:"quick_find"})))},this.handleFocus=()=>{const{onFocusChange:e}=this.props;e(!0)},this.handleBlur=()=>{const{onFocusChange:e}=this.props;e(!1)},this.styles={inputDesktop:{fontSize:18,height:S.DESKTOP_INPUT_HEIGHT,paddingLeft:12,paddingRight:16,alignItems:"center",flexGrow:0,flexShrink:0,zIndex:1},inputMobile:{fontSize:16,border:"none",boxShadow:"none",borderRadius:7,lineHeight:"1.2",padding:"6px 8px"},searchIcon:{width:16,height:16},headerIcon:{height:24,width:24,display:"flex",alignItems:"center",justifyContent:"center"},input:{minWidth:0,...d.Z.textOverflowStyle},suggestedText:{whiteSpace:"pre",color:this.theme.mediumTextColor},clearButton:{marginLeft:8}}}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){const{device:e}=this.environment,{isOpen:t,selectedResult:r}=this.props,o=this.styles,s=this.getThemeColors(),n=l.Jcv(null==r?void 0:r.getTitleValue()),a=m.ZP.state.query.text,d=void 0!==r&&(null==n?void 0:n.slice(0,a.length).toLocaleLowerCase())===a.toLocaleLowerCase()&&a&&a.length<20&&!e.isMobile,h=!d&&void 0!==r&&a&&a.length<20&&!e.isMobile;let c="";d?c=`${null==n?void 0:n.substring(a.length)} — ${S.messages.open.defaultMessage}`:h&&(c=n?` — ${S.messages.open.defaultMessage} ${n}`:` — ${S.messages.open.defaultMessage}`);const g=""!==c&&i()("div",{},void 0,i()("span",{},void 0,a),i()("span",{style:{background:this.theme.tint.regular}},void 0,c)),y=e.isMobile?v.Z.Format.ExtraLarge:v.Z.Format.Transparent,C=e.isMobile?{...o.inputMobile,...s.inputMobile}:{...o.inputDesktop,...s.inputDesktop};return i()(v.Z,{format:y,placeholder:this.getPlaceholderText(),left:this.renderLeft(),value:a,suggestedText:g,suggestedTextStyle:o.suggestedText,focus:e.isMobile?void 0:t&&!u.Z.state.open,focusInitial:!(0,p.Y)("supportsNativeHome")&&e.isMobile,focusAfterAnimation:!0,showClearButton:!0,selectAll:!0,onChange:this.handleQueryChange,onClearButtonClick:this.handleClearButtonClick,onFocus:this.handleFocus,onBlur:this.handleBlur,style:C,inputStyle:o.input})}updateIfIsFirstKeyStroke(){void 0===g.default.state.firstKeyStrokeTimeMs&&g.default.update((e=>({...e,firstKeyStrokeTimeMs:Date.now()})))}handleTyping(){this.updateIfIsFirstKeyStroke();const{onTypingChange:e}=this.props;this.typingTimer&&window.clearTimeout(this.typingTimer),e(!0),this.typingTimer=window.setTimeout((()=>e(!1)),S.TYPING_DEBOUNCE_MS)}getPlaceholderText(){const{currentSpaceStore:e,mainEditorCurrentBlockStore:t}=c.default.state,r=e&&(0,h.rn)(this.environment,e);if(r)return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedSpace",defaultMessage:"Search {spaceName}…"},{spaceName:r});if(t){const e=l.Jcv(t.getTitleValue()).slice(0,S.MAX_PLACEHOLDER_TITLE_LENGTH);return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedPage",defaultMessage:"Search in {pageTitle}…"},{pageTitle:e})}return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.unnamedPage",defaultMessage:"Search in page…"})}getThemeColors(){return{inputDesktop:{boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`},inputMobile:{background:this.theme.inputBackground},searchIcon:{fill:this.theme.mediumIconColor}}}}S.displayName="SearchInputMenuItem",S.messages=(0,a.defineMessages)({open:{id:"search.inputMenu.suggestedText.open",defaultMessage:"Open"}}),S.TYPING_DEBOUNCE_MS=300,S.DESKTOP_INPUT_HEIGHT=48,S.MAX_PLACEHOLDER_TITLE_LENGTH=100;const b=(0,a.injectIntl)(S)},25904:(e,t,r)=>{r.d(t,{Z:()=>s});var o=r(49085);class i extends o.default{getInitialState(){return{open:!1}}}const s=new i}}]);
"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[6215],{78387:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Yt});var o=i(23174),r=i.n(o),a=i(67294),n=i(83355),s=i(40902),d=i(92785),c=i(33709),l=i(97880),u=i(17652),m=i(69616),g=i(10434),h=i.n(g),v=i(480),p=i(86628),f=i(24405),b=i(5366),y=i(58129),A=i(21202),S=i(15047),M=i(29369),C=i(19889),_=i(82990),R=i(4708),k=i(33929),w=i(57559),O=i(49085),K=i(66897),I=i(7057),B=i(24211),V=i(72126),T=i(77420),x=i(48298),P=i(50906),L=i(91376),Z=i(64404),F=i(61519),E=i(62385),D=i(64369);class q extends n.Z{constructor(){super(...arguments),this.storeTypes={role:O.default.createClass(void 0)}}renderComponent(){const{accessRequestStore:e}=this.props;if(e.isDefined()){if(e.isResolvedSpaceMembershipRequest())return this.renderResolvedSpaceMembershipRequest();if(this.canResolveMembershipRequests())return r()("div",{style:{display:"flex",alignItems:"center"}},void 0,r()(E.Z,{onClick:()=>this.resolveMembershipRequest("approved"),style:this.getButtonStyle(!1)},void 0,r()(b.FormattedMessage,{defaultMessage:"Approve",id:"approveSpaceMembershipActivityAction.approveButton.label"})),r()(E.Z,{onClick:()=>this.resolveMembershipRequest("rejected"),style:{height:26,paddingLeft:8,paddingRight:8}},void 0,r()(b.FormattedMessage,{defaultMessage:"Decline",id:"approveSpaceMembershipActivityAction.declineButton.label"})),!this.environment.device.isMobile&&a.createElement(a.Fragment,null,r()(F.Z,{size:1,vertical:!0,style:{height:26,paddingLeft:8,paddingRight:8}}),r()(E.Z,{onClick:()=>{P.E50(this.environment,{disable_membership_requests:this.props.spaceStore.getDisableMembershipRequests()}),this.handleOpenSettingsMembersRequests()},style:{height:26,paddingLeft:8,paddingRight:8}},void 0,r()(b.FormattedMessage,{defaultMessage:"View all requests",id:"approveSpaceMembershipActivityAction.viewAllRequests.label"}))))}}renderResolvedSpaceMembershipRequest(){const{accessRequestStore:e,spaceStore:t}=this.props;if(!e.isDefined())return;const i=e.getResolvedByPointer(t.id),o=e.isResolvedSpaceMembershipRequest()&&i&&this.renderActor(i);return a.createElement(a.Fragment,null,r()(D.Z,{isSecondaryColor:!0},void 0,"approved"===e.getStatus()?r()(b.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestApproved.title",values:{grantedBy:o}}):r()(b.FormattedMessage,{defaultMessage:"Declined by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestDeclined.title",values:{grantedBy:o}})),r()(D.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,I.Yx)(Math.min(e.getResolvedTime()??1/0,Date.now()),"medium_with_time",(0,B.E2)(this.props.intl))))}handleOpenSettingsMembersRequests(){L.r$({currentTab:"members",subtab:Z.Q.Requests})}canResolveMembershipRequests(){return this.props.spaceStore.canEditMembership()}renderActor(e){const{table:t,id:i}=e,o=V.oA([this.getActor(t,i)]);return(0,m.XW)(o)}getActor(e,t){if(e===C.KJ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,K.dp)(i)}if(e===T.cZ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,K.D$)(i)}}get rootStore(){return this.props.accessRequestStore}async resolveMembershipRequest(e){if(!this.canResolveMembershipRequests())return;const t=this.environment,{spaceStore:i,accessRequestStore:o}=this.props;if(!o.isDefined())return;const r=this.getActor(C.KJ,o.getForActorId());r&&r.table===C.KJ&&await x.kn({environment:t,store:i,accessRequestStore:o,forActor:r.__IM_SORRY__getValue(),status:e,from:"notification"})}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}}q.displayName="ApproveSpaceMembershipActivityAction";const z=(0,b.injectIntl)(q);var U=i(13991),H=i(27006),G=i(54368),N=i(19719),W=i(17659),j=i(76464),J=i(9953),Y=i(39699),$=i(78291),X=i(25225),Q=i(7567);class ee extends n.Z{constructor(){super(...arguments),this.storeTypes={role:O.default.createClass(void 0)},this.handleApproveMembershipRequest=async()=>{},this.handleGrantPageAccess=async()=>{const{targetBlockStore:e,accessRequestStore:t}=this.props,i=this.getInviteTargetWithNewPermissionItem();if(!("permissionItem"in i))return;const o=this.environment.currentUser.id;if(!o)return;if("type"in i){let t;if("existingUser"===i.type){t=(await j.n_({environment:this.environment,store:e,inviteTargets:[i],inviteRole:i.permissionItem.role,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else if("bot"===i.type){t=(await j.n_({environment:this.environment,store:e,inviteTargets:[i],inviteRole:void 0,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else(0,l.t1)(i);if(!t)return}Y.createAndCommit({userAction:"GrantPageAccessActivityAction.handleGrantPageAccess",environment:this.environment,perform:r=>{"type"in i||j.ep({environment:this.environment,transaction:r,store:e,permissionItems:[i.permissionItem]}),J.sW({store:t,transaction:r,data:{granted_time:Date.now(),granted_by_table:C.KJ,granted_by_id:o,resolved_time:Date.now(),resolved_by_table:C.KJ,resolved_by_id:o,status:"approved"}})}});const r=t.getValue(),a=r&&r.created_time&&r.granted_time?r.granted_time-r.created_time:void 0;P.nCD(this.environment,{requestId:r&&r.id,timeElapsedSinceRequest:a,newAccessLevel:i.permissionItem.role,...this.getGrantOrIgnoreAccessArgs()})},this.handleRoleChange=e=>{const t=this.props.accessRequestStore.id,i=this.stores.role.state;this.stores.role.setState(e),P.If_(this.environment,{requestId:t,previousAccessLevel:i,newAccessLevel:e,...this.getGrantOrIgnoreAccessArgs()})},this.handleArchive=()=>{const{notification:e}=this.props;e&&(Y.createAndCommit({userAction:"GrantPageAccessActivityAction.handleArchive",environment:this.environment,perform:t=>{W.aZ({notification:e,rootStore:this.props.accessRequestStore,transaction:t})}}),P.cOL(this.environment,this.getGrantOrIgnoreAccessArgs()))}}renderComponent(){const e=this.props.accessRequestStore.getValue();if(!e)return;if((0,y.Kc)(e))return this.renderGrantedAccessRequest(e);if(!this.canGrantAccess())return;const t=e.parent_table===S.bx,i=this.getCurrentPermissionItem();if(i&&!t){const t=this.renderActor(e.for_actor_table,e.for_actor_id),o=i.role===this.getRole();return a.createElement(a.Fragment,null,r()(D.Z,{isSecondaryColor:!0,style:{marginBottom:6}},void 0,r()(b.FormattedMessage,{defaultMessage:"{requestingUser} already has access.",id:"grantPageAccessActivityAction.alreadyHasAccess.label",values:{requestingUser:t}})),r()(Q.ZP,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:A.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===C.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!0)}),r()(E.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(o)},void 0,r()(b.FormattedMessage,{defaultMessage:"Change",id:"grantPageAccessActivityAction.changePermissionButton.label"})),this.renderArchiveButton())}return a.createElement(a.Fragment,null,r()(Q.ZP,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:A.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===C.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!1)}),r()(E.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(!1)},void 0,r()(b.FormattedMessage,{defaultMessage:"Grant access",id:"grantPageAccessActivityAction.grantAccessButton.label"})),this.renderArchiveButton())}renderGrantedAccessRequest(e){const t=this.renderActor(e.granted_by_table,e.granted_by_id),i=(0,I.$b)(Math.min(e.granted_time,Date.now()),U.SP,k.default.getIntl());return a.createElement(a.Fragment,null,r()(D.Z,{isSecondaryColor:!0},void 0,r()(b.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"grantPageAccessActivityAction.accessGranted.title",values:{grantedBy:t,time:i}})),r()(D.Z,{isSmall:!0,isSecondaryColor:!0},void 0,i))}renderArchiveButton(){const{notification:e}=this.props;if(e&&!e.visited)return r()(E.Z,{onClick:this.handleArchive,style:{height:26,paddingLeft:8,paddingRight:8}},void 0,r()(b.FormattedMessage,{defaultMessage:"Ignore",id:"grantPageAccessActivityAction.ignoreButton.label"}))}getRole(){const e=this.getCurrentPermissionItem(),t=e&&e.role;return this.stores.role.state||t||this.props.initialRole}getNewPermissionItem(){const e=this.props.accessRequestStore.getValue();if(e)return e.for_actor_table===C.KJ?{type:"user_permission",user_id:e.for_actor_id,role:this.getRole()}:e.for_actor_table===T.cZ?{type:"bot_permission",bot_id:e.for_actor_id,role:this.getRole()}:void(e.for_actor_table!==G.y&&(0,l.t1)(e.for_actor_table))}getInviteTargetWithNewPermissionItem(){const e=this.getNewPermissionItem();if(!e)return{};if(this.getCurrentPermissionItem())return{permissionItem:e};const{data:t}=$.default.state;if("user_permission"===e.type){const i=this.rootStore.getRecordValue({table:C.KJ,id:e.user_id}),o=t?X.CM(t):[],r=o&&o.some((t=>t.userId===e.user_id));return i&&!r?{type:"existingUser",value:i,permissionItem:e}:{permissionItem:e}}if("bot_permission"===e.type){const i=this.rootStore.getRecordValue({table:T.cZ,id:e.bot_id}),o=(t?X.NM(t):[]).some((t=>t.botId===e.bot_id));return i&&!o?{type:"bot",value:i,permissionItem:e}:{permissionItem:e}}(0,l.t1)(e)}getCurrentPermissionItem(){const e=this.props.accessRequestStore.getValue();if(!e)return;const t=this.props.targetBlockStore.getPermissionItems();for(const i of t){if(e.for_actor_table===C.KJ&&(0,H.jg)(i)&&i.user_id===e.for_actor_id)return i;if(e.for_actor_table===T.cZ&&(0,H.FB)(i)&&i.bot_id===e.for_actor_id)return i}}canGrantAccess(){return this.props.targetBlockStore.canAdmin()}renderActor(e,t){const i=V.oA([this.getActor(e,t)]);return(0,m.XW)(i)}getActor(e,t){if(e===C.KJ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,K.dp)(i)}if(e===T.cZ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,K.D$)(i)}}get rootStore(){return this.props.accessRequestStore}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}getGrantOrIgnoreAccessArgs(){const{notification:e}=this.props;return{tab:N.Jn(),activityId:null==e?void 0:e.activity_id,notificationId:null==e?void 0:e.id}}}ee.displayName="GrantPageAccessActivityAction";const te=ee;var ie=i(18698);const oe=function(e){window.__c={n:"ApproveTeamMembershipActivityButton"};const{accessRequestStore:t,teamStore:i}=e,o=(0,v.O7)(),a=(0,b.useIntl)(),{isRequestResolved:n,resolvedStatus:s,resolvedTime:d}=(0,p.VK)((()=>({isRequestResolved:t.isResolvedTeamMembershipRequest(),resolvedStatus:t.getStatus(),resolvedTime:t.getResolvedTime()})),[t]),c=(0,p.VK)((()=>{const e=t.getResolvedById();if(!e)return;const i=w.U6.createChildStore(t,{table:C.KJ,id:e});return i?i.getDisplayName(a):void 0}),[t,a]),l=async e=>{await ie.ow({environment:o,teamStore:i,accessRequestStore:t,status:e})},u=(0,f.yK)((e=>({container:{display:"flex",alignItems:"center"},approveButton:{height:26,paddingLeft:8,paddingRight:8,fontSize:12,marginRight:10,fontWeight:500,boxShadow:e.plainButtonBoxShadow},declineButton:{height:26,paddingLeft:8,paddingRight:8}})),[]);return r()("div",{style:u.container},void 0,n?r()("div",{},void 0,r()(D.Z,{isSecondaryColor:!0},void 0,r()(b.FormattedMessage,"approved"===s?{defaultMessage:"Approved by {grantedBy}",id:"approveTeamMembershipActivityButton.requestApproved.title",values:{grantedBy:c}}:{defaultMessage:"Declined by {grantedBy}",id:"approveTeamMembershipActivityButton.requestDeclined.title",values:{grantedBy:c}})),r()(D.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,I.Yx)(Math.min(d??0,Date.now()),"medium_with_time",(0,B.E2)(a)))):r()("div",{},void 0,r()(E.Z,{style:u.approveButton,onClick:()=>l("approved")},void 0,r()(b.FormattedMessage,{defaultMessage:"Approve",id:"approveTeamMembershipActivityButton.approveButton.label"})),r()(E.Z,{style:u.declineButton,onClick:()=>l("rejected")},void 0,r()(b.FormattedMessage,{defaultMessage:"Decline",id:"approveTeamMembershipActivityButton.declineButton.label"}))))};var re=i(74970),ae=i(17022),ne=i(12472),se=i(22649),de=i(78976),ce=i(69651),le=i(8504),ue=i(37834),me=i(43250),ge=i(12534),he=i(16402),ve=i(4761),pe=i(73063),fe=i(86176),be=i(26388),ye=i(67706),Ae=i(8576),Se=i(32469),Me=i(93963);function Ce(e){window.__c={n:"ActivityNotificationSection"};const[t,i]=(0,a.useState)(!1),[o,n]=(0,a.useState)(!1),{notification:s,prominentTitleLink:d,children:c,rootStore:l,icon:m,isPrivate:g,isLast:h,onBacklinkClicked:b,onArchiveClicked:y,onNotificationFrameClicked:A,onMarkAsReadClicked:S,onMarkAsUnreadClicked:M,showRecordPath:C,navigableBlockId:_,showSnapshotButton:R,timestamp:k,header:w}=e,O=(0,p.VK)((()=>(0,u.H)()),[]),K=(0,v.O7)(),I=(0,p.VK)((()=>"mentions"===ve.ZP.state.currentTab),[]),B=!s||s.read,V=K.device.isMobile,T=Boolean(B&&I&&!R&&s),x=(0,p.VK)((()=>T&&O),[T,O]),P=(0,p.VK)((()=>{const e=K.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[K.WindowSizeStore]),L=(0,f.yK)((e=>({container:{paddingTop:12,paddingBottom:c?12:8,paddingLeft:V?P.left:0,paddingRight:V?P.right:0,...T&&{opacity:.7},...x&&{opacity:.7,backgroundColor:e.sidebarBackground}},headerAndAvatar:{display:"flex",paddingLeft:16,paddingRight:16},avatarAndStatusDot:{display:"flex",alignItems:"flex-start",position:"relative"},statusDot:{position:"absolute",opacity:1,left:-7,top:10},statusDotWrapper:{marginRight:V?3:2},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},divider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[c,P,V,T,x]),Z=(0,a.useCallback)((e=>{s&&!s.read&&(o||(0,ge.ZP)({event:e,context:ge.Af.NotificationClick,callback:()=>{A(),Y.createAndCommit({userAction:"ActivityNotificationSection.handleMarkAsRead",environment:K,perform:e=>{W.$h({notification:s,rootStore:l,transaction:e,read:!0})}})}}))}),[K,o,s,A,l]),F=(0,a.useCallback)((()=>i(!0)),[]),E=(0,a.useCallback)((()=>i(!1)),[]),D=(0,a.useId)();return r()("article",{onMouseOver:F,onMouseLeave:E,onClick:Z,"aria-labelledby":D,tabIndex:0},void 0,r()(_e,{notification:s,rootStore:l,isMobile:V,isHovered:t,isMentionsTab:I,onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onArchiveClicked:y,onMarkAsReadClicked:S,onMarkAsUnreadClicked:M}),r()("div",{style:L.container},void 0,r()("div",{style:L.headerAndAvatar},void 0,r()("div",{className:me.FoE,style:L.avatarAndStatusDot},void 0,r()("div",{style:{marginRight:4}},void 0,I&&r()("div",{style:L.statusDotWrapper},void 0,!B&&r()(Me.z,{style:L.statusDot}))),m),r()(Re,{timestamp:k,header:w,prominentTitleLink:d,hasChildren:Boolean(c),navigableBlockId:_,rootStore:l,onBacklinkClick:b,showRecordPath:C,titleAriaId:D,isHovered:t}),R&&_&&r()(ke,{timestamp:k,navigableBlockId:_,rootStore:l}),g&&!s&&r()(Se.Z,{style:L.privatePageBadge})),c&&r()("div",{className:me.nU_},void 0,c)),(O||!h)&&r()("div",{style:L.divider}))}function _e(e){window.__c={n:"InboxActions"};const{notification:t,rootStore:i,isMobile:o,isHovered:a,isMentionsTab:n,onArchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:c,onMouseEnter:l,onMouseLeave:u}=e,m=(0,f.yK)((()=>({container:{display:"flex",alignItems:"flex-start",position:"relative"},body:{transition:"opacity 100ms ease-out",opacity:o||a?1:0,position:"absolute",right:16,top:12,zIndex:1}})),[o,a]);return n&&t?t.visited?null:r()("div",{style:m.container,onMouseEnter:l,onMouseLeave:u},void 0,r()("div",{style:m.body},void 0,r()(Ae.Z,{notification:t,rootStore:i,onArchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:c}))):null}function Re(e){window.__c={n:"Header"};const{timestamp:t,prominentTitleLink:i,header:o,hasChildren:a,navigableBlockId:n,rootStore:s,showRecordPath:d,onBacklinkClick:c,titleAriaId:l,isHovered:m}=e,g=(0,he.IS)(t,{useCompactFormat:!0}),h=(0,v.O7)().device.isMobile,b=(0,he.uy)(t),y=(0,p.VK)((()=>(0,u.H)()),[]),S=(0,f.yK)((e=>({container:{width:"100%"},header:{width:h?"calc(100% - 98px)":"calc(100% - 90px)",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:h?28:void 0,display:"flex",alignItems:"baseline"},flatIndentHeader:{width:h?"calc(100% - 98px)":"100%",fontSize:14,lineHeight:1.4,minWidth:0,minHeight:h?28:void 0,display:"flex",justifyContent:"space-between",alignItems:"baseline"},title:{fontSize:14,marginTop:4,marginBottom:a?8:4},time:{fontSize:12,color:e.lightTextColor,whiteSpace:"nowrap",display:"inline",paddingLeft:6,...y?!h&&m?{opacity:0}:{opacity:1}:{}},path:{marginTop:4,marginBottom:4},separatorDot:{fontSize:12,color:e.lightTextColor,marginLeft:4,marginRight:4}})),[a,h,m,y]);return r()("div",{style:S.container},void 0,y&&!h?r()("div",{style:S.flatIndentHeader},void 0,r()("div",{style:{width:"calc(100% - 90px)"},className:me.NFf},void 0,r()("span",{id:l},void 0,o)),r()("div",{style:S.time,className:me.CZG},void 0,r()(ye.Z,{text:g,tooltipText:b,icon:ce.C}))):r()("div",{style:S.header},void 0,r()("div",{className:me.NFf},void 0,r()("span",{id:l},void 0,o),r()("div",{style:S.time,className:me.CZG},void 0,r()(ye.Z,{text:g,tooltipText:b,icon:ce.C})))),d&&n&&s&&r()("div",{style:S.path},void 0,r()(fe.Z,{isLink:!0,store:w.G.createChildStore(s,{table:A.iU,id:n}),onClick:c})),i&&r()("div",{style:S.title},void 0,i))}function ke(e){window.__c={n:"SnapshotButton"};const{timestamp:t,navigableBlockId:i,rootStore:o}=e,n=(0,v.O7)();if(t<new Date("2018-10-26").getTime())return null;const s=k.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),d=()=>{const e=w.G.createChildStore(o,{table:A.iU,id:i});ue.jN({environment:n,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return r()(be.Z,{renderTooltip:()=>s,render:e=>a.createElement(pe.Z,h()({ariaLabel:s,onClick:d,icon:le.J},e))})}const we=a.memo(Ce);function Oe(e){let{activity:t,rootStore:i,tabArgs:o,isLast:n}=e;window.__c={n:"AccessRequestedActivity"};const{notification:s,tab:d,source:c}=o,l=(0,a.useMemo)((()=>t.getEdits()),[t]),u=l[0],g=(0,v.O7)(),A=g.device.isMobile,M=(0,f.yK)((()=>({message:{paddingLeft:(0,se.c3)({source:c,isMobile:A}),paddingRight:16,marginTop:8,marginBottom:8},messageLabel:{whiteSpace:"pre-wrap"}})),[c,A]),C=(0,p.VK)((()=>w.oK.createChildStore(i,{table:y.J8,id:t.access_request_id})),[t,i]),_=(0,p.VK)((()=>C.getModel()),[C]),k=(0,p.VK)((()=>(null==_?void 0:_.getParentTable())===S.bx&&!(0,R.p1)()),[_]),O=_&&r()(Ke,{activity:t,accessRequest:_,rootStore:i,tabArgs:o}),K=u.message,I=(0,p.VK)((()=>(0,m.P6)({edits:l,rootStore:i})),[l,i]),B=(0,p.VK)((()=>(0,m.XW)(I)),[I]),V=(0,p.VK)((()=>parseInt(t.end_time)),[t]);return k||!O?null:a.createElement(we,h()({timestamp:V,header:r()("span",{},void 0,O),isLast:n,isPrivate:!1,rootStore:i,showRecordPath:!1,notification:s,icon:r()(re.BE,{authors:I}),showSnapshotButton:!1},(0,ae.h9)({notification:s,activity:t,environment:g,tab:d})),K&&r()("div",{style:M.message},void 0,r()(D.Z,{isSmall:!0},void 0,r()(b.FormattedMessage,{id:"activity.accessRequested.messageLabel",defaultMessage:"Message from {author}",values:{author:B}})),r()(D.Z,{isMultiline:!0,style:M.messageLabel},void 0,K)),r()(Te,{activity:t,accessRequestStore:C,rootStore:i,source:c,notification:s}),r()(ne.Z,{tabArgs:o,activity:t,isMobile:g.device.isMobile,environment:g,rootStore:i}))}function Ke(e){window.__c={n:"AccessRequestHeader"};const{activity:t,accessRequest:i,rootStore:o,tabArgs:a}=e,n=(0,p.VK)((()=>i.getParentTable()),[i]);switch(n){case S.bx:return r()(Be,{activity:t,accessRequest:i,rootStore:o});case M.e0:return r()(Ve,{activity:t,rootStore:o,tabArgs:a});case A.iU:return r()(Ie,{activity:t,tabArgs:a,rootStore:o});default:(0,l.t1)(n)}}function Ie(e){window.__c={n:"BlockAccessRequestHeader"};const{activity:t,rootStore:i,tabArgs:o}=e,n=(0,a.useMemo)((()=>t.getEdits()),[t]),s=(0,p.VK)((()=>(0,m.P6)({edits:n,rootStore:i})),[n,i]),d=(0,p.VK)((()=>(0,m.XW)(s)),[s]),c=(0,p.VK)((()=>{if(t.navigable_block_id)return w.G.createChildStore(i,{table:A.iU,id:t.navigable_block_id})}),[t,i]);return c?r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to {pageName}} other {{authorOrAuthors} requested access to {pageName}}}",values:{numberOfAuthors:s.length,authorOrAuthors:d,pageName:r()(de.Z,{titledRecordStore:c,activity:t,tabArgs:o,getRecordModel:i.getRecordModel})},id:"activity.accessRequested.header"}):null}function Be(e){window.__c={n:"MembershipRequestHeader"};const{activity:t,accessRequest:i,rootStore:o}=e,n=(0,a.useMemo)((()=>t.getEdits()),[t]),s=(0,f.yK)((()=>({inviteePhrase:{fontWeight:_.Z.fontWeight.semibold}})),[]),d=(0,p.VK)((()=>i.getForActorPointer(o.id)),[i,o.id]),c=d.table===C.KJ?w.U6.createChildStore(o,d):void 0,l=(0,p.VK)((()=>null==c?void 0:c.getModel()),[c]),u=(0,p.VK)((()=>null==l?void 0:l.getEmail()),[l]),g=(0,p.VK)((()=>i.getForActorId()===i.getCreatedById()),[i]),h=(0,p.VK)((()=>(0,m.P6)({edits:n,rootStore:o})),[n,o]),v=(0,p.VK)((()=>(0,m.XW)(h)),[h]),y=(0,p.VK)((()=>{if(!g)return u;const e=null==l?void 0:l.getFullName(k.default.getIntl());return e?`${e} (${u})`:u}),[g,l,u]);return l&&d.table===C.KJ?r()(b.FormattedMessage,g?{defaultMessage:"{invitee} requested to become a workspace member",values:{invitee:r()("span",{style:s.inviteePhrase},void 0,y)},id:"activity.accessRequestedMembershipFromGuest.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested {invitee} to become a workspace member} other {{authorOrAuthors} requested {invitee} to become a workspace member}}",values:{numberOfAuthors:h.length,authorOrAuthors:v,invitee:r()("span",{style:s.inviteePhrase},void 0,y)},id:"activity.accessRequestedMembership.header"}):null}function Ve(e){window.__c={n:"TeamMembershipRequestHeader"};const{activity:t,rootStore:i,tabArgs:o}=e,n=(0,a.useMemo)((()=>t.getEdits()),[t]),s=(0,p.VK)((()=>(0,m.P6)({edits:n,rootStore:i})),[n,i]),d=(0,p.VK)((()=>(0,m.XW)(s)),[s]),c=(0,p.VK)((()=>{if(t.team_id)return w.zX.createChildStore(i,{table:M.e0,id:t.team_id})}),[t,i]);return n&&c?r()(b.FormattedMessage,{defaultMessage:"{user} requested to become a member of {teamName}",values:{user:r()("span",{style:{fontWeight:_.Z.fontWeight.semibold}},void 0,d),teamName:r()(de.Z,{titledRecordStore:c,getRecordModel:i.getRecordModel,activity:t,tabArgs:o})},id:"activity.teamAccessRequest.header"}):null}function Te(e){window.__c={n:"AccessRequestedActions"};const{activity:t,accessRequestStore:i,rootStore:o,source:n,notification:s}=e,d=(0,a.useMemo)((()=>t.getEdits()),[t])[0],c=(0,p.VK)((()=>i.getParentTable()),[i]),u=(0,p.VK)((()=>i.getParentId()),[i]),m=(0,v.O7)().device.isMobile,g=(0,f.yK)((e=>({actionPrimaryContainer:{paddingLeft:(0,se.c3)({source:n,isMobile:m}),paddingTop:12,paddingBottom:8},actionButton:(0,se.b9)(e)})),[n,m]),h=u?w.G.createChildStore(o,{table:A.iU,id:u}):void 0,b=(0,p.VK)((()=>c===A.iU&&Boolean(null==h?void 0:h.canAdmin())),[c,h]);if(!c||!u||!d)return null;switch(c){case A.iU:return b&&h?r()("div",{style:g.actionPrimaryContainer},void 0,r()(te,{accessRequestStore:i,targetBlockStore:h,initialRole:"reader",buttonStyle:g.actionButton,notification:s})):null;case S.bx:const e=w.H2.createChildStore(o,{table:c,id:u});return r()("div",{style:g.actionPrimaryContainer},void 0,r()(z,{accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:g.actionButton,notification:s}));case M.e0:const t=w.zX.createChildStore(o,{table:c,id:u});return r()("div",{style:g.actionPrimaryContainer},void 0,r()(oe,{accessRequestStore:i,teamStore:t}));default:(0,l.t1)(c)}}const xe=a.memo(Oe);var Pe=i(15145),Le=i(41432),Ze=i(89101),Fe=i(99108),Ee=i(84076),De=i(63381),qe=i(13658);function ze(e){window.__c={n:"BlockPropertyEditedActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:n}=e,{tab:s,notification:d,source:c}=o,l=(0,p.VK)((()=>(0,Fe.hI)(t.getEdits())),[t]),u=l.length>0,g=w.G.createChildStore(i,{table:A.iU,id:l[0].navigable_block_id}),f=(0,p.VK)((()=>(0,m.P6)({edits:l,rootStore:i})),[l,i]),y=(0,p.VK)((()=>(0,m.XW)(f)),[f]),S=(0,v.O7)(),M=(0,p.VK)((()=>(0,m.jC)({recordId:g.id,recordType:"block",tab:s,rootStore:i,environment:S})),[g,s,i,S]),C=(0,p.VK)((()=>g.isDefined()),[g]),_=(0,p.VK)((()=>parseInt(t.end_time)),[t]);if(!C||!u)return null;const R=r()(de.Z,{titledRecordStore:g,getRecordModel:i.getRecordModel,activity:t,tabArgs:o}),k="pageUpdatesSidebar"===s;return a.createElement(we,h()({timestamp:_,header:r()("span",{},void 0,r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated {pageTitle}} other {{authorOrAuthors} updated {pageTitle}}}",id:"activity.blockEdited.standardizedHeader",values:{numberOfAuthors:f.length,authorOrAuthors:y,pageTitle:R}})),isLast:n,isPrivate:M,rootStore:i,navigableBlockId:g.id,notification:d,icon:r()(re.BE,{authors:f}),showSnapshotButton:k,showRecordPath:!0},(0,ae.h9)({notification:d,activity:t,environment:S,tab:s})),r()(qe.Z,{visible:5,items:l.map(((e,a)=>r()(Ue,{edit:e,rootStore:i,onClick:()=>(0,ae.dG)({environment:S,activity:t,...o}),source:c,isMobile:S.device.isMobile},a)))}),r()(ne.Z,{tabArgs:o,activity:t,isMobile:S.device.isMobile,environment:S,rootStore:i}))}function Ue(e){window.__c={n:"BlockPropertyEditComponent"};const{rootStore:t,edit:i,onClick:o,source:a,isMobile:n}=e,s=(0,p.VK)((()=>function(e,t){const i=t.getRecordModel({table:A.iU,id:e.block_id}),o=(null==i?void 0:i.getType())===Le.Ti.tableRow?t.getRecordModel({table:A.iU,id:i.getParentId()}):i;return null==o?void 0:o.getRenderUrl({getRecordModel:t.getRecordModel,pageVisitSource:Pe.tY.Notification})}(i,t)||Ze._j.root),[i,t]);return r()(Ee.Z,{href:s,onClick:o,innerStyle:(0,se.OD)({source:a,isMobile:n})},void 0,r()(De.Z,{edit:i,rootStore:t}))}var He=i(45433),Ge=i(23867),Ne=i(70203),We=i(4083),je=i(60682),Je=i(14976),Ye=i(98165),$e=i(92559);function Xe(e){let{activity:t,tabArgs:i,rootStore:o,isLast:n}=e;window.__c={n:"CommentActivityNotification"};const s=(0,p.VK)((()=>t.getEdits()),[t]),{source:d,tab:u,notification:g}=i;let y=s.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":return!0;default:(0,l.t1)(e)}}));0===y.length&&0!==s.length&&"updates_sidebar"!==d&&(y=s);const S=y.length>0,M=(0,v.O7)(),C=(0,p.VK)((()=>{const e=o.getRecordStore(o,{table:c.qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,o]),_=(0,p.VK)((()=>{const e=null==C?void 0:C.getParentPointer();if(e)return w.G.createChildStore(o,e)}),[C,o]),R=(0,p.VK)((()=>Boolean(_&&_.isDefined())),[_]),k=(0,p.VK)((()=>{const e=null==_?void 0:_.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,_]),O=w.G.createChildStore(o,{table:A.iU,id:k}),K=(0,p.VK)((()=>O.isDefined()),[O]),I=(0,p.VK)((()=>Boolean(_&&(0,Ye.fl)((0,Ye.qA)(_)))),[_]),B=(0,p.VK)((()=>{if(!I||!_)return;const e=_.getModel();return e?e.getRenderUrl({getRecordModel:o.getRecordModel,discussionId:t.discussion_id,pageVisitSource:Pe.tY.Notification}):void 0}),[I,_,o,t]),V=(0,p.VK)((()=>(0,m.P6)({edits:y,rootStore:o})),[y,o]),T=(0,p.VK)((()=>(0,m.XW)(V)),[V]),x=I,P=(0,f.yK)((()=>({flex:{display:"flex"}})),[]),L=(0,a.useCallback)((e=>{if((0,ae.dG)({...i,environment:M,activity:t,mightCloseTab:x}),!I&&_&&C){var o;const r=e.target;We.oK({environment:M,discussionStore:C,rect:r.getBoundingClientRect(),blockStore:_,discussionLocation:it({forReplyMenu:!0,source:i.source}),activityId:t.id,notificationId:null===(o=i.notification)||void 0===o?void 0:o.id})}}),[t,I,_,C,M,i,x]),Z=(0,a.useCallback)((()=>{(0,ae.BE)({...i,environment:M,activity:t,mightCloseTab:x})}),[i,M,t,x]),F=r()(de.Z,{titledRecordStore:O,getRecordModel:o.getRecordModel,activity:t,tabArgs:i}),E=(0,p.VK)((()=>(0,m.jC)({recordId:k,recordType:A.iU,tab:u,rootStore:o,environment:M})),[k,u,o,M]),D=M.device.isMobile,q=(0,p.VK)((()=>it({source:d,forReplyMenu:!1})),[d]),z=(0,p.VK)((()=>(0,m.cr)({activity:t,rootStore:o})),[t,o]),U=null==z?void 0:z.id,H=null==z?void 0:z.context,G=(0,p.VK)((()=>{const e=O.getAssociatedCollectionStore();return null==e?void 0:e.getDatabaseType()}),[O]),N=(0,p.VK)((()=>parseInt(t.end_time)),[t]);if(!(S&&K&&R&&C))return null;const W=!H,j=r()("div",{style:P.flex},void 0,W&&r()($e.Z,{}),F),J=function(e){let{databaseType:t,authorCount:i,authorPhrase:o}=e;switch(t){case He.iS:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a task} other {{authorOrAuthors} commented on a task}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentTaskActivity.standardizedHeader"});case He.wW:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a project} other {{authorOrAuthors} commented on a project}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentProjectActivity.standardizedHeader"});case He.zU:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a document} other {{authorOrAuthors} commented on a document}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentDocActivity.standardizedHeader"});case He.GZ:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a wiki} other {{authorOrAuthors} commented on a wiki}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentWikiActivity.standardizedHeader"});case He.Fi:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a meeting note} other {{authorOrAuthors} commented on a meeting note}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentMeetingActivity.standardizedHeader"});case He.nG:case He.Be:case He.p$:case void 0:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a page} other {{authorOrAuthors} commented on a page}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentActivity.standardizedHeader"});default:(0,l.t1)(t)}}({authorCount:V.length,authorPhrase:T,databaseType:G});return a.createElement(we,h()({timestamp:N,header:r()("span",{},void 0,J),isLast:n,isPrivate:E,rootStore:o,prominentTitleLink:j,navigableBlockId:k,notification:g,icon:r()(re.BE,{authors:V}),showSnapshotButton:!1,showRecordPath:!0},(0,ae.h9)({notification:g,environment:M,tab:u,activity:t})),r()(Qe,{discussionId:U,discussionContext:H,alwaysHighlightWithBlockBar:!0,url:B,onClick:L,rootStore:o,source:d}),r()(qe.Z,{visible:5,items:y.map(((e,t,i)=>r()(Ee.Z,{onClick:L,href:B,innerStyle:(0,se.OD)({source:d,isMobile:D})},t,r()(De.Z,{edit:e,rootStore:o,type:"comment-edit",discussionLocation:q,highlightCurrentUser:!0,onReactionClick:Z,hideAuthorName:1===y.length}))))}),r()(et,{activity:t,rootStore:o,tabArgs:i}))}function Qe(e){window.__c={n:"CommentContext"};const{url:t,onClick:i,rootStore:o,source:a,discussionId:n,alwaysHighlightWithBlockBar:s,discussionContext:d}=e,c=0===(0,Ne.llS)(d).length||s,l=(0,v.O7)(),u=l.device.isMobile,m=(0,f.Fg)(),g=(0,f.yK)((e=>({linkbox:{...(0,se.OD)({source:a,isMobile:u}),display:"flex",alignItems:"center",fontSize:14,...c&&{color:e.mediumTextColor},paddingTop:2,paddingBottom:6,marginBottom:0}})),[u,a,c]),h=(0,p.VK)((()=>(0,Je.IY)({environment:l,textValue:d?{value:d,spaceId:o.id}:void 0,parentStore:o,disableHover:!0,disableStyleAnnotations:c,disableDateStyleAnnotations:!1,disabled:!0,highlightDiscussionId:n,theme:m,emojiType:(0,je.e_)(l),katex:l.KatexStore.getKatex(),formulaValueTypes:[]})),[o,l,d,n,m,c]);return d?r()(Ee.Z,{href:t,onClick:i,innerStyle:g.linkbox},void 0,c&&r()($e.Z,{}),r()("div",{style:_.Z.textOverflowStyle},void 0,h)):null}function et(e){window.__c={n:"CommentActions"};const{activity:t,rootStore:i,tabArgs:o}=e,{source:n,notification:s,tab:d}=o,l=(0,p.VK)((()=>{const e=i.getRecordStore(i,{table:c.qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,i]),u=(0,v.O7)(),m=u.device.isMobile,g=(0,p.VK)((()=>w.t1.createChildStore(i,{table:c.qF,id:t.discussion_id,spaceId:(0,Ge.C)(i.pointer.spaceId)})),[t,i]),h=(0,p.VK)((()=>null==l?void 0:l.getParentId()),[l]),y=(0,a.useCallback)((e=>{if(!h)return;const o=w.G.createChildStore(i,{table:A.iU,id:h}),r=e.target,a=null==s?void 0:s.id;We.oK({environment:u,discussionStore:g,rect:r.getBoundingClientRect(),blockStore:o,discussionLocation:it({forReplyMenu:!0,source:n}),activityId:t.id,notificationId:a}),"notifications_tab"===n&&N.gY({environment:u,notificationId:a,alreadyRead:Boolean(null==s?void 0:s.read),activity:t,tab:d})}),[t,g,u,s,h,i,n,d]),S=(0,f.yK)((e=>({container:{paddingLeft:(0,se.c3)({source:n,isMobile:m}),paddingTop:12,paddingBottom:4},actionButton:(0,se.b9)(e)})),[m,n]),M=Boolean(null==s?void 0:s.visited);return l?r()("div",{style:S.container},void 0,r()(E.Z,{onClick:y,style:S.actionButton},void 0,r()(b.FormattedMessage,{defaultMessage:"Reply",id:"activity.replyButton.label"})),M&&a.createElement(a.Fragment,null,r()(tt,{}),r()(ne.D,{tabArgs:o,environment:u,rootStore:i,activity:t}))):null}function tt(){return r()("div",{style:{width:5,display:"inline-block"}})}function it(e){const{forReplyMenu:t,source:i}=e;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${N.Jn()}`}const ot=a.memo(Xe);var rt=i(65598),at=i(77907),nt=i(2456),st=i(64921),dt=i(31278),ct=i(76798),lt=i(70301),ut=i(45653),mt=i(65187);function gt(e){let{activity:t,tabArgs:i,rootStore:o,isLast:n}=e;window.__c={n:"CommentActivityWithIndentedGroupingIA"};const s=(0,p.VK)((()=>t.getEdits()),[t]),{source:d,tab:u,notification:g}=i;let b=s.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":return!0;default:(0,l.t1)(e)}}));0===b.length&&0!==s.length&&"updates_sidebar"!==d&&(b=s);const y=b.length>0,S=(0,v.O7)(),M=(0,p.VK)((()=>o.getRecordStore(o,{table:c.qF,id:t.discussion_id,spaceId:t.space_id})),[o,t]),C=(0,p.VK)((()=>M.isDefined()),[M]),R=(0,p.VK)((()=>{const e=M.getParentPointer();if(e)return w.G.createChildStore(o,e)}),[M,o]),k=(0,p.VK)((()=>Boolean(R&&R.isDefined())),[R]),O=(0,p.VK)((()=>{const e=null==R?void 0:R.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,R]),K=w.G.createChildStore(o,{table:A.iU,id:O}),I=(0,p.VK)((()=>K.isDefined()),[K]),B=(0,p.VK)((()=>Boolean(R&&(0,Ye.fl)((0,Ye.qA)(R)))),[R]),V=(0,p.VK)((()=>{if(!B||!R)return;const e=R.getModel();return e?e.getRenderUrl({getRecordModel:o.getRecordModel,discussionId:t.discussion_id,pageVisitSource:Pe.tY.Notification}):void 0}),[B,R,o,t]),T=(0,p.VK)((()=>(0,m.P6)({edits:b,rootStore:o})),[b,o]),x=(0,p.VK)((()=>(0,m.XW)(T)),[T]),P=B,L=(0,f.yK)((()=>({flex:{display:"flex"},header:{fontWeight:_.Z.fontWeight.semibold},discussionThreadContainer:{display:"flex",flexDirection:"column",marginTop:vt}})),[]),Z=(0,a.useCallback)((e=>{if((0,ae.dG)({...i,environment:S,activity:t,mightCloseTab:P}),!B&&R){var o;const r=e.target;We.oK({environment:S,discussionStore:M,rect:r.getBoundingClientRect(),blockStore:R,discussionLocation:it({forReplyMenu:!0,source:i.source}),activityId:t.id,notificationId:null===(o=i.notification)||void 0===o?void 0:o.id})}}),[t,B,R,M,S,i,P]),F=(0,a.useCallback)((()=>{(0,ae.BE)({...i,environment:S,activity:t,mightCloseTab:P})}),[i,S,t,P]),E=(0,p.VK)((()=>(0,m.jC)({recordId:O,recordType:A.iU,tab:u,rootStore:o,environment:S})),[O,u,o,S]),D=S.device.isMobile,q=(0,p.VK)((()=>it({source:d,forReplyMenu:!1})),[d]),z=(0,p.VK)((()=>(0,m.cr)({activity:t,rootStore:o})),[t,o]),U=(0,p.VK)((()=>t.discussion_id),[t]),H=null==z?void 0:z.context,G=(0,p.VK)((()=>{const e=K.getAssociatedCollectionStore();return null==e?void 0:e.getDatabaseType()}),[K]),N=(0,p.VK)((()=>parseInt(t.end_time)),[t]);if(!(y&&I&&k&&C))return null;const W=r()(yt,{authorCount:T.length,authorPhrase:x,databaseType:G,commentCount:b.length});return r()(st.Z,{href:V},void 0,a.createElement(we,h()({timestamp:N,header:r()("span",{style:L.header},void 0,W),isLast:n,isPrivate:E,rootStore:o,prominentTitleLink:void 0,navigableBlockId:O,notification:g,icon:r()(re.BE,{authors:T}),showSnapshotButton:!1,showRecordPath:!1},(0,ae.h9)({notification:g,environment:S,tab:u,activity:t})),r()(bt,{navigableBlockStore:K,discussionId:U,discussionContext:H,alwaysHighlightWithBlockBar:!0,url:V,onClick:Z,rootStore:o,source:d}),r()("div",{style:L.discussionThreadContainer},void 0,U&&r()("div",{style:{...(0,se.OD)({source:d,isMobile:D})}},void 0,r()(ht,{rootStore:o,discussionId:U,url:V,discussionLocation:q,onReactionClick:F})))))}function ht(e){window.__c={n:"DiscussionThread"};const{rootStore:t,discussionId:i,url:o,discussionLocation:n,onReactionClick:s}=e,d=(0,p.VK)((()=>w.t1.createChildStore(t,{table:c.qF,id:i,spaceId:t.id})),[t,i]),u=(0,p.VK)((()=>rt.D4(d).filter((e=>e.isDefined()))),[d]),m=(0,p.VK)((()=>{const e=u.map((e=>e.getCreatedByPointer())).filter(l.$K).filter((e=>e.table===C.KJ));return(0,V.mN)(e,(e=>{let{id:t}=e;return t})).map((e=>w.t1.createChildStore(d,e)))}),[d,u]),g=u.length>3,h=u.length-3,v=(0,f.yK)((e=>({discussion:{display:"flex",flexDirection:"column",gap:vt},truncateRepliesButton:{display:"flex",gap:8,padding:4,marginLeft:-4,borderRadius:3},avatars:{display:"flex"},truncationText:{display:"flex",alignItems:"center",color:e.lightTextColor,fontSize:12}})),[]);return r()("div",{style:v.discussion},void 0,g?a.createElement(a.Fragment,null,r()(pt,{commentStore:u[0],discussionLocation:n,onReactionClick:s}),r()(st.Z,{href:o,style:v.truncateRepliesButton},void 0,r()("div",{style:v.avatars},void 0,m.map(((e,t)=>{const i=t===m.length-1;return r()(ut.Z,{userStore:e,size:24,isOffline:!1,avatarShouldShowShadow:!1,style:{position:"relative",...!i&&{marginRight:-5}}},e.id)}))),r()("div",{style:v.truncationText},void 0,r()(b.FormattedMessage,{id:"CommentGroupingActivity.discussionThread.commentTruncatedReplies",defaultMessage:"{numberOfTruncatedReplies} {numberOfTruncatedReplies, plural, one {reply...} other {replies...}}",values:{numberOfTruncatedReplies:h}}))),r()(pt,{commentStore:u[u.length-2],discussionLocation:n,onReactionClick:s}),r()(pt,{commentStore:u[u.length-1],discussionLocation:n,onReactionClick:s})):a.createElement(a.Fragment,null,u.map(((e,t)=>r()(pt,{commentStore:e,discussionLocation:n,onReactionClick:s},t)))))}const vt=12;function pt(e){window.__c={n:"DiscussionThreadComment"};const{commentStore:t,discussionLocation:i,onReactionClick:o}=e,n=(0,b.useIntl)(),[s,d]=(0,a.useState)(!1),c=(0,p.VK)((()=>{const e=t.getCreatedByPointer();if(e)return w.t1.createChildStore(t,e)}),[t]),u=(0,p.VK)((()=>c?c.getDisplayName(n):r()(b.FormattedMessage,{id:"CommentGroupingActivity.discussionThreadComment.unknownAuthorLabel",defaultMessage:"Unknown author"})),[c,n]),m=(0,p.VK)((()=>{const e=t.getContent(),i=0===e.length;if(e||!i)return e.map((e=>{const i=w.t1.createChildStore(t,{table:A.iU,id:e,spaceId:t.getSpaceId()}).getValue();if(i)return r()(nt.ZP,{blockValue:i,rootStore:t},e)})).filter(l.$K)}),[t]),g=(0,p.VK)((()=>t.getUserVisibleReactions().length>0),[t]),h=(0,p.VK)((()=>!g),[g]),v=(0,p.VK)((()=>t.getLastEditedTime()>t.getCreatedTime()+100),[t]);let y;c?c.table===T.cZ?y=r()(lt.Z,{botStore:c,size:24}):c.table===C.KJ?y=r()(ut.Z,{userStore:c,size:24}):c.table===G.y?y=r()(ut.Z,{userStore:void 0,size:24}):(0,l.t1)(c):y=r()(ut.Z,{userStore:void 0,size:24});const S=(0,f.yK)((e=>({avatarCommentReactionBarContainer:{...h&&{position:"relative"}},avatarAndCommentContainer:{display:"flex",gap:vt},commentContainer:{display:"flex"},commentClampContainer:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,verticalAlign:"top",textAlign:"left",lineHeight:_.Z.lineHeight.UIRegular.desktop,..._.Z.textOverflowStyle,color:e.accentColors.gray[500]},commentText:{display:"inline",fontSize:14,color:e.accentColors.gray[500],lineHeight:_.Z.lineHeight.UIRegular.desktop},fullName:{fontWeight:_.Z.fontWeight.semibold,fontSize:14,lineHeight:_.Z.lineHeight.UIRegular.desktop,marginRight:8,color:e.regularTextColor},editedBadge:{color:e.mediumTextColor,paddingLeft:4},reactionBar:{...h?{position:"absolute",top:-3,right:3}:{marginTop:-4,marginLeft:24+vt}}})),[h]);return r()("div",{style:S.avatarCommentReactionBarContainer,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1)},void 0,r()("div",{style:S.avatarAndCommentContainer},void 0,r()("div",{},void 0,y),r()("div",{style:S.commentContainer},void 0,r()("span",{style:S.commentClampContainer},void 0,r()("span",{style:S.fullName},void 0,u),r()(mt.Z,{style:S.commentText,store:rt.zP(t),disabled:!0,disableDateMentions:!0,disableEquationInteraction:!0}),m,v&&r()("span",{style:S.editedBadge},void 0,r()(b.FormattedMessage,{id:"CommentGroupingActivity.discussionThreadComment.editedBadge",defaultMessage:"(edited)"}))))),(s||g)&&r()("div",{style:S.reactionBar},void 0,r()(at.LazyReactionBar,{parentStore:t,discussionLocation:i,onClick:o})))}function ft(e){window.__c={n:"PageTitle"};const{store:t}=e,i=(0,p.VK)((()=>t.getIcon()),[t]),o=(0,p.VK)((()=>t.isEmptyPage()),[t]),a=(0,f.yK)((()=>({container:{display:"flex",gap:4,alignItems:"center"},recordTitle:{..._.Z.textOverflowStyle}})),[]);return r()("div",{style:a.container},void 0,r()(dt.Z,{icon:i,isEmptyPage:o,size:14,disabled:!0}),r()(ct.Z,{store:t,style:a.recordTitle}))}function bt(e){window.__c={n:"CommentContextForGrouping"};const{navigableBlockStore:t,rootStore:i,source:o,discussionId:a,alwaysHighlightWithBlockBar:n,discussionContext:s}=e,d=0===(0,Ne.llS)(s).length||n,c=(0,v.O7)(),l=c.device.isMobile,u=(0,f.Fg)(),m=(0,f.yK)((e=>({linkbox:{...(0,se.OD)({source:o,isMobile:l}),display:"flex",alignItems:"center",fontSize:14,...d&&{color:e.mediumTextColor},paddingTop:2,paddingBottom:6,marginBottom:0},highlight:{backgroundColor:e.accentColors.yellow[50],paddingLeft:4,paddingRight:4,borderRadius:2,color:e.accentColors.yellow[500],maxWidth:"100%",..._.Z.textOverflowStyle}})),[l,o,d]),g=(0,p.VK)((()=>s?(0,Je.IY)({environment:c,textValue:s?{value:s,spaceId:i.id}:void 0,parentStore:i,disableHover:!0,disableStyleAnnotations:d,disableDateStyleAnnotations:!1,disabled:!0,highlightDiscussionId:a,theme:u,emojiType:(0,je.e_)(c),katex:c.KatexStore.getKatex(),formulaValueTypes:[]}):r()(ft,{store:t})),[t,i,c,s,a,u,d]);return r()("div",{style:m.linkbox},void 0,r()("div",{style:{maxWidth:"100%",borderLeftWidth:2,borderLeftColor:u.accentColors.yellow[500],borderLeftStyle:"solid",paddingLeft:4}},void 0,r()("div",{style:m.highlight},void 0,g)))}function yt(e){let{databaseType:t,authorCount:i,authorPhrase:o,commentCount:a}=e;switch(t){case He.iS:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a task} other {{authorOrAuthors} commented on a task}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentTaskActivity.standardizedHeader"});case He.wW:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a project} other {{authorOrAuthors} commented on a project}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentProjectActivity.standardizedHeader"});case He.zU:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a document} other {{authorOrAuthors} commented on a document}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentDocActivity.standardizedHeader"});case He.GZ:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a wiki} other {{authorOrAuthors} commented on a wiki}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentWikiActivity.standardizedHeader"});case He.Fi:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented on a meeting note} other {{authorOrAuthors} commented on a meeting note}}",values:{numberOfAuthors:i,authorOrAuthors:o},id:"activity.commentMeetingActivity.standardizedHeader"});case He.nG:case He.p$:case He.Be:case void 0:return r()(b.FormattedMessage,1===i?{defaultMessage:"{author} {commentCount, plural, one {left a comment} other {left comments}}",values:{author:o,commentCount:a},id:"activity.commentActivity.standardizedGroupedHeader.singleAuthor"}:{defaultMessage:"{authors} {commentCount, plural, one {left a comment} other {left comments}}",values:{authors:o,commentCount:a},id:"activity.commentActivity.standardizedGroupedHeader.multipleAuthors"});default:(0,l.t1)(t)}}const At=a.memo(gt);const St=function(e){window.__c={n:"EmailEditedActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:n}=e,{tab:s,notification:d}=o,c=(0,v.O7)(),l=(0,p.VK)((()=>(0,Fe.hI)(t.getEdits())),[t]),u=(0,p.VK)((()=>(0,m.P6)({edits:l,rootStore:i})),[l,i]),g=(0,p.VK)((()=>(0,m.XW)(u)),[u]),{oldEmail:f,newEmail:y}=(0,p.VK)((()=>{const e=l[0];return{oldEmail:e?e.old_email:"",newEmail:e?e.new_email:""}}),[l]),A="pageUpdatesSidebar"===s,S=(0,p.VK)((()=>parseInt(t.end_time)),[t]);return a.createElement(we,h()({timestamp:S,header:r()("span",{},void 0,r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} changed email from {oldEmail} to {newEmail}} other {{authorOrAuthors} changed email from {oldEmail} to {newEmail}}}",values:{numberOfAuthors:u.length,authorOrAuthors:g,oldEmail:f,newEmail:y},id:"activity.emailEdited.header"})),isLast:n,isPrivate:!1,rootStore:i,showRecordPath:!1,notification:d,icon:r()(re.BE,{authors:u}),showSnapshotButton:A},(0,ae.h9)({notification:d,activity:t,environment:c,tab:s})))};var Mt=i(54584);function Ct(e){window.__c={n:"GroupMentionedActivity"};const{activity:t,rootStore:i,isLast:o,tabArgs:n}=e,{tab:s,notification:d,source:c}=n,l=(0,v.O7)(),u=(0,p.VK)((()=>t.getEdits()),[t]),g=u.length>0,f=u[0],y=w.G.createChildStore(i,{table:A.iU,id:f.navigable_block_id}),S=(0,p.VK)((()=>y.isDefined()),[y]),M=(0,p.VK)((()=>{const e=w.G.createChildStore(i,{table:A.iU,id:t.mentioned_block_id});if(!e.isDefined())return;const o=e.getModel();return null==o?void 0:o.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:Pe.tY.Notification})}),[t,i]),C=(0,p.VK)((()=>i.getModel()),[i]),_=(0,p.VK)((()=>(0,Mt.QH)(k.default.getIntl(),C,t.mentioned_group_id)),[C,t]),R=(0,p.VK)((()=>(0,m.P6)({edits:t.getEdits(),rootStore:i})),[t,i]),O=(0,p.VK)((()=>(0,m.XW)(R)),[R]),K=l.device.isMobile,I=(0,p.VK)((()=>(0,m.jC)({recordId:y.id,recordType:A.iU,tab:s,rootStore:i,environment:l})),[y,s,i,l]),B=(0,p.VK)((()=>parseInt(t.end_time)),[t]);if(!g||!S||!M)return null;const V=r()(de.Z,{titledRecordStore:y,activity:t,tabArgs:n,getRecordModel:i.getRecordModel});return a.createElement(we,h()({timestamp:B,header:r()("span",{},void 0,r()(b.FormattedMessage,{defaultMessage:"{authorOrAuthors} mentioned {groupName} in a page",values:{authorOrAuthors:O,groupName:_},id:"activity.groupMentionActivity.standardizedHeader"})),isLast:o,isPrivate:I,rootStore:i,prominentTitleLink:V,navigableBlockId:y.id,showRecordPath:!0,notification:d,icon:r()(re.BE,{authors:R}),showSnapshotButton:!1},(0,ae.h9)({notification:d,activity:t,environment:l,tab:s})),r()(Ee.Z,{href:M,onClick:()=>(0,ae.dG)({environment:l,activity:t,...n}),innerStyle:(0,se.OD)({source:c,isMobile:K})},void 0,r()(De.Z,{edit:f,rootStore:i,highlightCurrentUser:!0})),r()(ne.Z,{tabArgs:n,activity:t,isMobile:K,environment:l,rootStore:i}))}const _t=function(e){window.__c={n:"PrivateContentTransferredActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:n}=e,{tab:s,notification:d}=o,c=(0,v.O7)(),l=(0,a.useMemo)((()=>t.getEdits()),[t]),u=(0,p.VK)((()=>(0,m.P6)({edits:l,rootStore:i})),[l,i]),g=(0,p.VK)((()=>(0,m.XW)(u)),[u]),f=(0,p.VK)((()=>{const e=w.G.createChildStore(i,{table:A.iU,id:t.navigable_block_id});if(e.isDefined())return e}),[t,i]),y=(0,p.VK)((()=>Boolean(f&&(0,m.jC)({recordId:f.id,recordType:A.iU,tab:s,rootStore:i,environment:c}))),[f,s,i,c]),S=(0,p.VK)((()=>parseInt(t.end_time)),[t]),M=l[0],_=(0,p.VK)((()=>(0,m.N8)(M.from_user_id,i)),[M,i]),R=(0,p.VK)((()=>(0,m.N8)(M.to_user_id,i)),[M,i]);if(!(l.length>0&&_&&R&&f))return null;const O=(0,K.$4)(k.default.getIntl(),(0,K.LU)({table:C.KJ,value:_})),I=r()(de.Z,{titledRecordStore:f,activity:t,tabArgs:o,getRecordModel:i.getRecordModel});return a.createElement(we,h()({timestamp:S,header:r()(b.FormattedMessage,{defaultMessage:"{authorPhrase} transferred private content from {fromUserName} to you",values:{authorPhrase:g,fromUserName:O},id:"activity.privateContentTransferred.standardizedHeader"}),isLast:n,prominentTitleLink:I,isPrivate:y,rootStore:i,notification:o.notification,icon:r()(re.BE,{authors:u}),showSnapshotButton:!1,showRecordPath:!1},(0,ae.h9)({notification:d,activity:t,environment:c,tab:s})))};function Rt(e){window.__c={n:"ReminderActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:n}=e,{notification:s,tab:d,source:c}=o,l=(0,v.O7)(),u=(0,p.VK)((()=>t.getEdits()),[t]),g=u.length>0,f=w.G.createChildStore(i,{table:A.iU,id:u[0].navigable_block_id}),y=(0,p.VK)((()=>f.isDefined()),[f]),S=(0,p.VK)((()=>{const e=w.G.createChildStore(i,{table:A.iU,id:t.reminder_block_id}).getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:Pe.tY.Notification})}),[t,i]),M=(0,p.VK)((()=>(0,m.jC)({recordId:f.id,recordType:A.iU,tab:d,rootStore:i,environment:l})),[f,d,i,l]),C=(0,p.VK)((()=>parseInt(t.end_time)),[t]);if(!g||!y||!S)return null;const _=l.device.isMobile,R=r()(de.Z,{titledRecordStore:f,getRecordModel:i.getRecordModel,activity:t,tabArgs:o});return a.createElement(we,h()({timestamp:C,header:r()("span",{},void 0,r()(b.FormattedMessage,{defaultMessage:"Reminder in {pageTitle}",id:"activity.reminderInActivity.header",values:{pageTitle:R}})),isLast:n,isPrivate:M,rootStore:i,navigableBlockId:f.id,showRecordPath:!0,notification:s,icon:r()(re.hZ,{}),showSnapshotButton:!1},(0,ae.h9)({notification:s,activity:t,environment:l,tab:d})),r()(Ee.Z,{href:S,onClick:()=>(0,ae.dG)({environment:l,activity:t,...o}),innerStyle:(0,se.OD)({source:c,isMobile:_})},void 0,r()(De.Z,{edit:u[0],rootStore:i})))}var kt=i(45094),wt=i(95697),Ot=i(62820),Kt=i(35817);function It(e){window.__c={n:"TitleCard"};const{titledRecordStore:t,rootStore:i,activity:o,tabArgs:n}=e,s=i.getRecordModel,d=(0,p.VK)((()=>t.getModel()),[t]),c=(0,v.O7)(),u=(0,p.VK)((()=>null==d?void 0:d.getRenderIcon({getRecordModel:s})),[d,s]),m=(0,f.yK)((e=>({container:{...se.lS,display:"block",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:3,marginTop:8,padding:10},icon:{...se.e9,marginRight:8},activityTitle:{display:"inline",whiteSpace:"normal",marginRight:void 0!==u?3:0,wordBreak:"break-word",...se.nP},flexRow:{display:"flex",alignItems:"center"},title:{maxWidth:"80%"},spacer:{flexGrow:1},subtitle:{fontSize:12,color:e.lightTextColor},avatarContainer:{display:"flex",flexDirection:"row",justifyContent:"start",overflow:"hidden",paddingRight:2,alignItems:"center"},overlappingAvatar:{marginRight:-5,position:"relative"},rightmostAvatar:{position:"relative"},remainderCount:{paddingLeft:2,color:e.lightTextColor}})),[u]),g=(0,p.VK)((()=>{if(d&&d.table!==M.e0)return d.getRenderUrl({getRecordModel:s,pageVisitSource:Pe.tY.Notification})}),[d,s]),h=(0,a.useCallback)((()=>{const e=t.table;switch(e){case A.iU:case S.bx:(0,ae.V3)({environment:c,activity:o,...n});break;case M.e0:(0,ae.dG)({environment:c,activity:o,...n}),Kt.hI({environment:c,teamStore:t,shouldScroll:!0}),Ot.Z.setState({...Ot.Z.state,open:!1});break;default:(0,l.t1)(e)}}),[o,c,n,t]),y=(0,p.VK)((()=>{const e=t.table;switch(e){case"space":const i=t.getPublicSpaceData();return i&&"none"!==i.role?r()("div",{},void 0,r()(b.FormattedMessage,{id:"activity.titleCard.spaceSubtitle",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}}  {planType}",values:{numberOfWorkspaceMembers:k.default.formatNumber(i.memberCount),planType:k.default.formatMessage((0,kt.em)(i.subscriptionTier))}})):null;case"block":return r()(fe.Z,{store:t});case"team":const o=t.getUserIdsInTeam().length,a=t.getTeamAccessLevel();return r()("div",{},void 0,r()(b.FormattedMessage,{id:"activity.titleCard.teamSubtitle",defaultMessage:"{accessLevel}  {numberOfTeamMembers, plural, one {{numberOfTeamMembers} member} other {{numberOfTeamMembers} members}}",values:{accessLevel:a,numberOfTeamMembers:o}}));default:(0,l.t1)(e)}}),[t]),_=(0,p.VK)((()=>{const e=t.table;let o=[];switch(e){case"space":const r=t.getModel();if(!r)break;o=r.getUserPermissionItems().map((e=>e.user_id));break;case"block":const a=t.getCreatedByPointer();(null==a?void 0:a.table)===C.KJ&&(o=[a.id]);break;case"team":o=(0,wt.xf)({teamStore:t,spaceStore:i});break;default:(0,l.t1)(e)}const a=Math.max(0,o.length-3),n=Math.min(o.length,3);return r()("div",{style:m.avatarContainer},void 0,o.slice(0,3).map(((e,i)=>{const o=w.U6.createChildStore(t,{table:C.KJ,id:e}),a=i===n-1;if(o)return r()(ut.Z,{userStore:o,size:24,avatarShouldShowShadow:!1,style:a?m.rightmostAvatar:m.overlappingAvatar,isOffline:!1,hasTooltip:!c.device.isMobile})})),a>0&&r()("div",{style:m.remainderCount},void 0,r()(b.FormattedMessage,{defaultMessage:"{remainingAvatarCount, plural, one {+{remainingAvatarCount}} other {+{remainingAvatarCount}}}",id:"activity.titleCard.members.otherCount.message",values:{remainingAvatarCount:a}})))}),[c.device.isMobile,m,t,i]);return d?r()(Ee.Z,{href:g,onClick:h,external:!1,innerStyle:m.container,inline:!0},void 0,r()("div",{style:m.flexRow},void 0,u&&r()(dt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:25,style:m.icon}),r()("div",{style:m.title},void 0,r()(ct.Z,{store:t,style:m.activityTitle}),r()("div",{style:m.subtitle},void 0,y)),r()("div",{style:m.spacer}),r()("div",{},void 0,_))):null}const Bt=a.memo(It);function Vt(e){window.__c={n:"TeamMembershipEditedActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:n}=e,{notification:s,tab:d}=o,c=(0,v.O7)(),l=(0,p.VK)((()=>t.getEdits()),[t]),u=l.length>0,g=(0,p.VK)((()=>(0,m.P6)({edits:l,rootStore:i})),[l,i]),f=(0,p.VK)((()=>(0,m.XW)(g)),[g]),y=l[0],A=w.zX.createChildStore(i,{table:M.e0,id:y.team_id}),S=(0,p.VK)((()=>A.isDefined()),[A]),C=(0,p.VK)((()=>parseInt(t.end_time)),[t]);return u&&S?a.createElement(we,h()({timestamp:C,header:r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a teamspace} other {{authorOrAuthors} invited you to a teamspace}}",values:{numberOfAuthors:g.length,authorOrAuthors:f},id:"activity.userInvitedToTeamActivity.standardizedHeader"}),prominentTitleLink:r()(Bt,{titledRecordStore:A,rootStore:i,activity:t,tabArgs:o}),isLast:n,isPrivate:!1,rootStore:i,notification:s,showRecordPath:!1,icon:r()(re.BE,{authors:g}),showSnapshotButton:!1},(0,ae.h9)({notification:s,activity:t,environment:c,tab:d}))):null}var Tt=i(55061),xt=i(84683),Pt=i(94044),Lt=i(63143),Zt=i(36081);function Ft(e){window.__c={n:"UserInvitedActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:n}=e,{notification:s,tab:d}=o,c=(0,v.O7)(),u=(0,p.VK)((()=>t.getEdits()),[t]),g=u[0],f=zt({rootStore:i,edit:g}),b=function(e){let{data:t,spaceId:i,tab:o,rootStore:r}=e;const a=(0,v.O7)();return(0,p.VK)((()=>{let e,n;if(!t)return!1;if("block"===(null==t?void 0:t.type))e=t.block.id,n="block";else if("space"===(null==t?void 0:t.type)||"group"===(null==t?void 0:t.type)){if(!i)return!1;e=i,n="space"}else(0,l.t1)(t);return(0,m.jC)({recordId:e,recordType:n,tab:o,rootStore:r,environment:a})}),[t,a,r,i,o])}({data:f,spaceId:g.space_id,tab:d,rootStore:i}),y=(0,p.VK)((()=>(0,m.P6)({edits:u,rootStore:i})),[u,i]),A=(0,a.useMemo)((()=>(0,ae.h9)({notification:s,environment:c,tab:d,activity:t})),[t,c,s,d]),S=(0,p.VK)((()=>parseInt(t.end_time)),[t]),M=(0,p.VK)((()=>t.navigable_block_id),[t]);if(0===u.length||!f)return null;const C=0===y.filter(K.uC).length,_=C?void 0:r()(re.BE,{authors:y});return a.createElement(we,h()({timestamp:S,header:r()("span",{},void 0,r()(Dt,{data:f,authors:y,isFromBot:C,spaceId:g.space_id})),prominentTitleLink:r()(Et,{data:f,rootStore:i,activity:t,tabArgs:o}),isLast:n,isPrivate:b,rootStore:i,navigableBlockId:M,showRecordPath:!1,notification:s,icon:_,showSnapshotButton:!1},A),a.createElement(qt,h()({},e,{edit:g})))}function Et(e){let{data:t,rootStore:i,activity:o,tabArgs:a}=e;switch(t.type){case"block":return r()(Bt,{tabArgs:a,titledRecordStore:t.block,rootStore:i,activity:o});case"group":return null;case"space":return r()(Bt,{tabArgs:a,titledRecordStore:t.space,rootStore:i,activity:o});default:(0,l.t1)(t)}}function Dt(e){let{data:t,authors:i,isFromBot:o,spaceId:a}=e;window.__c={n:"UserInviteSimplifiedHeader"};const n=(0,p.VK)((()=>(0,m.XW)(i)),[i]),s=(0,p.VK)((()=>{var e;return"block"===t.type?null===(e=t.block.getAssociatedCollectionStore())||void 0===e?void 0:e.getDatabaseType():void 0}),[t]);switch(t.type){case"block":if(o)switch(s){case He.wW:return r()(b.FormattedMessage,{defaultMessage:"You were added to a project",id:"activity.userInvitedActivityProjectByBot.standardizedHeader"});case He.iS:return r()(b.FormattedMessage,{defaultMessage:"You were added to a task",id:"activity.userInvitedActivityTaskByBot.standardizedHeader"});case He.zU:return r()(b.FormattedMessage,{defaultMessage:"You were added to a document",id:"activity.userInvitedActivityDocByBot.standardizedHeader"});case He.Fi:return r()(b.FormattedMessage,{defaultMessage:"You were added to a meeting",id:"activity.userInvitedActivityMeetingByBot.standardizedHeader"});case He.p$:return r()(b.FormattedMessage,{defaultMessage:"You were added to a sprint",id:"activity.userInvitedActivitySprintByBot.standardizedHeader"});case He.GZ:return r()(b.FormattedMessage,{defaultMessage:"You were added to a wiki",id:"activity.userInvitedActivityWikiByBot.standardizedHeader"});default:return r()(b.FormattedMessage,{defaultMessage:"You were added to a page",id:"activity.userInvitedActivityNavigableBlockByBot.standardizedHeader"})}else switch(s){case He.wW:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a project} other {{authorOrAuthors} added you to a project}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityProject.standardizedHeader"});case He.iS:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a task} other {{authorOrAuthors} added you to a task}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityTask.standardizedHeader"});case He.zU:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a document} other {{authorOrAuthors} added you to a document}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityDoc.standardizedHeader"});case He.Fi:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a meeting} other {{authorOrAuthors} added you to a meeting}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityMeeting.standardizedHeader"});case He.p$:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a sprint} other {{authorOrAuthors} added you to a sprint}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivitySprint.standardizedHeader"});case He.GZ:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a wiki} other {{authorOrAuthors} added you to a wiki}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityWiki.standardizedHeader"});default:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a page} other {{authorOrAuthors} added you to a page}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityNavigableBlock.standardizedHeader"})}case"group":const e=r()(Zt.Z,{permissionGroup:t.group,spaceId:a});return r()(b.FormattedMessage,o?{defaultMessage:"You were added to group {groupName}",values:{groupName:e},id:"activity.userInvitedActivityGroupIdByBot.standardizedHeader"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to group {groupName}} other {{authorOrAuthors} added you to group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:n,groupName:e},id:"activity.userInvitedActivityGroupId.standardizedHeader"});case"space":return r()(b.FormattedMessage,o?{defaultMessage:"You were added to a workspace",id:"activity.userInvitedActivityOtherInviteByBot.standardizedHeader"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to a workspace} other {{authorOrAuthors} added you to a workspace}}",values:{numberOfAuthors:i.length,authorOrAuthors:n},id:"activity.userInvitedActivityOtherInvite.standardizedHeader"});default:(0,l.t1)(t)}}function qt(e){let{edit:t,activity:i,rootStore:o,tabArgs:a}=e;window.__c={n:"InviteDetail"};const n=(0,v.O7)(),{isMobile:s}=n.device,{source:d}=a,c=(0,f.yK)((()=>({inviteMessage:{paddingLeft:(0,se.c3)({source:d,isMobile:s}),paddingTop:8,paddingBottom:8,paddingRight:12,fontSize:14}})),[s,d]),l=zt({rootStore:o,edit:t}),u=(0,p.VK)((()=>parseInt(i.end_time)),[i]),m=(0,p.VK)((()=>{if("block"!==(null==l?void 0:l.type))return;const e=l.block;return null!=e&&e.isDefined()?e.getModel():void 0}),[l]),g=(0,p.VK)((()=>{if(m)return(0,ae.ME)(m.getRenderUrl({getRecordModel:o.getRecordModel,pageVisitSource:Pe.tY.Notification}))}),[m,o.getRecordModel]),h=(0,p.VK)((()=>{if(!m)return{isValid:!1};const e=m&&(0,Pt.$e)(m,i);if(!e)return{isValid:!1};const t=o.getRecordModel({table:xt.Tu,id:e,spaceId:i.space_id});return t&&t.getMessage()&&t.getCreatedTime()<=u+5*Lt.hM?{isValid:!0,message:t.getMessage()}:{isValid:!1}}),[i,u,m,o]);return null!=h&&h.isValid?r()(Ee.Z,{href:g,onClick:()=>(0,ae.dG)({...a,environment:n,activity:i,mightCloseTab:!0}),innerStyle:c.inviteMessage},void 0,h.message):null}function zt(e){let{rootStore:t,edit:i}=e;return(0,p.VK)((()=>{if(i)return i.navigable_block_id?{type:"block",block:w.G.createChildStore(t,{table:A.iU,id:i.navigable_block_id})}:i.permission_group_id?{type:"group",group:(0,Tt.Bg)({spaceId:i.space_id,permissionGroupId:i.permission_group_id,getRecordValue:t.getRecordValue})}:{type:"space",space:w.H2.createChildStore(t,{table:S.bx,id:i.space_id})}}),[i,t])}const Ut=a.memo(Ft);var Ht=i(70921);function Gt(e){window.__c={n:"UserMentionedActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:n}=e,{source:s,tab:d,notification:c}=o,l=(0,v.O7)(),u=(0,p.VK)((()=>t.getEdits()),[t]),g=u.length>0,f=u[0],y=w.G.createChildStore(i,{table:A.iU,id:f.navigable_block_id}),S=(0,p.VK)((()=>y.isDefined()),[y]),M=(0,p.VK)((()=>w.WJ.createChildStore(i,{table:Ht.TY,id:t.id,spaceId:t.space_id}).getStandardizedMentionedPropertyURI()),[t,i]),C=(0,p.VK)((()=>{const e=w.G.createChildStore(i,{table:A.iU,id:t.mentioned_block_id}).getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:i.getRecordModel,pageVisitSource:Pe.tY.Notification})}),[t,i]),_=(0,p.VK)((()=>(0,m.P6)({edits:u,rootStore:i})),[u,i]),R=(0,p.VK)((()=>(0,m.XW)(_)),[_]),k=(0,p.VK)((()=>(0,m.jC)({recordId:y.id,recordType:"block",tab:d,rootStore:i,environment:l})),[y,d,i,l]),O=(0,p.VK)((()=>parseInt(t.end_time)),[t]);if(!g||!S||!C)return null;const K=l.device.isMobile,I=r()(de.Z,{titledRecordStore:y,getRecordModel:i.getRecordModel,activity:t,tabArgs:o}),B=function(e,t,i){switch(e){case He.Es.Assign:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} assigned you a task} other {{authorOrAuthors} assigned you a task}}",values:{numberOfAuthors:i.length,authorOrAuthors:t},id:"activity.mentionTaskActivity.standardizedHeader"});case He.zI.People:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in a project} other {{authorOrAuthors} mentioned you in a project}}",values:{numberOfAuthors:i.length,authorOrAuthors:t},id:"activity.mentionProjectActivity.standardizedHeader"});default:return r()(b.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in a page} other {{authorOrAuthors} mentioned you in a page}}",values:{numberOfAuthors:i.length,authorOrAuthors:t},id:"activity.mentionActivity.standardizedHeader"})}}(M,R,_);return a.createElement(we,h()({timestamp:O,header:r()("span",{},void 0,B),isLast:n,isPrivate:k,rootStore:i,navigableBlockId:y.id,prominentTitleLink:I,notification:c,icon:r()(re.BE,{authors:_}),showRecordPath:!0,showSnapshotButton:!1},(0,ae.h9)({notification:c,activity:t,environment:l,tab:d})),r()(Ee.Z,{href:C,onClick:()=>(0,ae.dG)({environment:l,activity:t,...o}),innerStyle:(0,se.OD)({source:s,isMobile:K})},void 0,r()(De.Z,{edit:f,rootStore:i,highlightCurrentUser:!0})),r()(ne.Z,{tabArgs:o,activity:t,isMobile:K,environment:l,rootStore:i}))}var Nt=i(80951),Wt=i(6287);function jt(e){window.__c={n:"VerificationExpiredActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:n}=e,{tab:s,source:d,notification:c}=o,l=(0,v.O7)(),u=(0,p.VK)((()=>w.G.createChildStore(i,{table:A.iU,id:t.navigable_block_id})),[t,i]),g=(0,p.VK)((()=>u.isDefined()),[u]),f=w.NW.createChildStore(i,{table:Wt.v,id:t.collection_id,spaceId:t.space_id}),y=(0,p.VK)((()=>f.isDefined()),[f]),S=(0,p.VK)((()=>{const e=f.getSchema(),t=Object.keys(e).find((t=>{var i;return"verification"===(null===(i=e[t])||void 0===i?void 0:i.type)}));let o=r()(b.FormattedMessage,{id:"Activity.author.unknown",defaultMessage:"Unknown"});if(t){const e=u.getPropertyValue(t),r=Nt._w(e);if(r){const e=r[0],t=(0,m.uA)(e,i);t&&t.asActor&&(o=(0,m.XW)([t]))}}return o}),[u,f,i]),M=(0,p.VK)((()=>(0,m.jC)({recordId:u.id,recordType:"block",tab:s,rootStore:i,environment:l})),[u,s,i,l]),{activityStartTimestamp:C,activityEndTimestamp:_}=(0,p.VK)((()=>({activityStartTimestamp:parseInt(t.start_time),activityEndTimestamp:parseInt(t.end_time)})),[t]);if(!g||!y)return null;const R=r()(de.Z,{titledRecordStore:u,getRecordModel:i.getRecordModel,activity:t,tabArgs:o}),k=r()(b.FormattedMessage,{defaultMessage:"Verification expired for <boldtext>{pageTitle}</boldtext>",values:{pageTitle:R,boldtext:e=>r()("span",{style:{fontWeight:500}},void 0,e)},id:"activity.verificationExpired.header"}),O=l.device.isMobile,K=r()("div",{style:{fontSize:14,...(0,se.OD)({source:d,isMobile:O})}},void 0,r()(b.FormattedMessage,C&&_?{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:S,startDate:(0,he.gs)(C),endDate:(0,he.gs)(_)},id:"activity.verificationExpired.contentWithTimestamp"}:{defaultMessage:"Last verified by {person}",values:{person:S},id:"activity.verificationExpired.contentWithoutTimestamp"}));return a.createElement(we,h()({timestamp:_,header:k,isLast:n,isPrivate:M,rootStore:f,navigableBlockId:u.id,notification:c,icon:r()(re.of,{}),showRecordPath:!0,showSnapshotButton:!1},(0,ae.h9)({notification:c,activity:t,environment:l,tab:s})),K,r()(ne.Z,{tabArgs:o,activity:t,isMobile:l.device.isMobile,environment:l,rootStore:i}))}class Jt extends n.Z{constructor(){super(...arguments),this.getRecordStore=e=>this.props.rootStore.getRecordStore(this.props.rootStore,e),this.getDiscussionContext=()=>{const e=(0,m.cr)({activity:this.props.activity,rootStore:this.props.rootStore});if(e)return e.context}}willMountOrUpdate(){this.warmCommentData(),this.environment.KatexStore.loadIfNeeded(this.getDiscussionContext)}warmCommentData(){if("commented"===this.props.activity.type){const t=this.getRecordStore({table:c.qF,id:this.props.activity.discussion_id,spaceId:this.props.activity.space_id});if(t.isDefined()){const i=t.getCommentStores();for(const t of i){var e;null===(e=t.getCreatedByStore())||void 0===e||e.load()}}}}renderComponent(){const{activity:e,rootStore:t,tabArgs:i,isLast:o}=this.props,a=e.type;if(!s.n_(a))return d.log({level:"error",from:"ActivityNotification",type:"unsupportedActivityType",data:{message:`Activity type ${a} is not supported for ActivityNotification`}}),null;switch(a){case"block-property-edited":return r()(ze,{activity:e,rootStore:t,tabArgs:i,isLast:o});case"user-mentioned":return r()(Gt,{activity:e,rootStore:t,tabArgs:i,isLast:o});case"commented":return(0,u.H)()?r()(At,{activity:e,tabArgs:i,rootStore:t,isLast:o}):r()(ot,{activity:e,tabArgs:i,rootStore:t,isLast:o});case"user-invited":return r()(Ut,{activity:e,rootStore:t,tabArgs:i,isLast:o});case"reminder":return r()(Rt,{activity:e,rootStore:t,tabArgs:i,isLast:o});case"email-edited":return r()(St,{activity:e,rootStore:t,tabArgs:i,isLast:o});case"access-requested":return r()(xe,{activity:e,rootStore:t,tabArgs:i,isLast:o});case"team-membership-edited":return r()(Vt,{activity:e,rootStore:t,tabArgs:i,isLast:o});case"private-content-transferred":return r()(_t,{activity:e,rootStore:t,tabArgs:i,isLast:o});case"permission-group-mentioned":return r()(Ct,{activity:e,rootStore:t,tabArgs:i,isLast:o});case"verification-expired":return r()(jt,{activity:e,rootStore:t,tabArgs:i,isLast:o});default:(0,l.t1)(a)}}get getRecordValue(){return this.props.rootStore.getRecordValue}get getRecordModel(){return this.props.rootStore.getRecordModel}}Jt.displayName="ActivityNotification";const Yt=Jt}}]);